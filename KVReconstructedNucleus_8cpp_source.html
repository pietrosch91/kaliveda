<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>KaliVeda: kaliveda.doxygen/KVMultiDet/exp_events/KVReconstructedNucleus.cpp Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="ROOT.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">KaliVeda
   &#160;<span id="projectnumber">1.10/15</span>
   </div>
   <div id="projectbrief">Heavy-Ion Analysis Toolkit</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_ee2496c42ce3447ad0c4fd100b52f5e5.html">kaliveda.doxygen</a></li><li class="navelem"><a class="el" href="dir_74c7b176af7644ee55a1ecb9dd61ada5.html">KVMultiDet</a></li><li class="navelem"><a class="el" href="dir_a1247c4614c7c0f80c50b6f3dbbd7e3c.html">exp_events</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">KVReconstructedNucleus.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="KVReconstructedNucleus_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;</div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="preprocessor">#include &quot;Riostream.h&quot;</span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="KVReconstructedNucleus_8h.html">KVReconstructedNucleus.h</a>&quot;</span></div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="KVTelescope_8h.html">KVTelescope.h</a>&quot;</span></div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="KVIDTelescope_8h.html">KVIDTelescope.h</a>&quot;</span></div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="KVGroup_8h.html">KVGroup.h</a>&quot;</span></div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="KVMultiDetArray_8h.html">KVMultiDetArray.h</a>&quot;</span></div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="KVACQParam_8h.html">KVACQParam.h</a>&quot;</span></div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;</div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="keyword">using namespace </span><a class="code" href="namespacestd.html">std</a>;</div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;</div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;ClassImp(<a class="code" href="classKVReconstructedNucleus.html">KVReconstructedNucleus</a>);</div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;</div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;<span class="comment">//KVReconstructedNucleus</span></div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment">//Particles reconstructed from data measured in multidetector arrays using identification</span></div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment">//telescopes (see KVIDTelescope class).</span></div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="comment">//If the particle has been identified (IsIdentified()=kTRUE) and calibrated (IsCalibrated()=kTRUE)</span></div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="comment">//then information on its nature and kinematics can be obtained using the methods of parent</span></div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="comment">//classes KVNucleus and KVParticle (GetZ(), GetVelocity(), etc.).</span></div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="comment">//Information specific to the detection and identification of the particle:</span></div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="comment">//   GetDetectorList()         -  list of detectors passed through, in reverse order</span></div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="comment">//   GetNumDet()               -  number of detectors in list = number of detectors passed through</span></div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="comment">//   GetDetector(Int_t i)      -  ith detector in list (i=0 is stopping detector)</span></div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="comment">//   GetStoppingDetector()     -  detector in which particle stopped (first in list)</span></div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="comment">//   GetGroup()                -  group in which particle detected/stopped (see KVGroup)</span></div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="comment">//   GetTelescope()            -  telescope to which stopping detector belongs (see KVTelescope)</span></div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="comment">//   GetIdentifyingTelescope() -  ID telescope which identified this particle (see KVIDTelescope)</span></div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="comment">//      IsIdentified()               - =kTRUE if particle identification has been completed</span></div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="comment">//      IsCalibrated()             - =kTRUE if particle&#39;s energy has been set</span></div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="comment">//      GetIDTelescopes()     - list of ID telescopes through which particle passed.</span></div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="comment">//                                   this list is used to find an ID telescope which can identify the particle.</span></div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="comment">//    GetRealZ(), GetRealA()  -  return the Z and A determined with floating-point precision by the</span></div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="comment">//                               identification of the particle.</span></div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="comment">//</span></div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;</div><div class="line"><a name="l00084"></a><span class="lineno"><a class="line" href="classKVReconstructedNucleus.html#aa2a59c5233f1e1311ae3a101b8343538">   84</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classKVReconstructedNucleus.html#aa2a59c5233f1e1311ae3a101b8343538">KVReconstructedNucleus::init</a>()</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;{</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;   <span class="comment">//default initialisation</span></div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;   fRealZ = fRealA = 0.;</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;   fDetNames = <span class="stringliteral">&quot;/&quot;</span>;</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;   fIDTelName = <span class="stringliteral">&quot;&quot;</span>;</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;   fIDTelescope = 0;</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;   fNSegDet = 0;</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;   fAnalStatus = 99;</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;   fTargetEnergyLoss = 0;</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;   ResetBit(kIsIdentified);</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;   ResetBit(kIsCalibrated);</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;   ResetBit(kCoherency);</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;   ResetBit(kZMeasured);</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;   ResetBit(kAMeasured);</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;}</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;</div><div class="line"><a name="l00107"></a><span class="lineno"><a class="line" href="classKVReconstructedNucleus.html#a658008aa049a13c4b901ec58329d836a">  107</a></span>&#160;<a class="code" href="classKVReconstructedNucleus.html#a658008aa049a13c4b901ec58329d836a">KVReconstructedNucleus::KVReconstructedNucleus</a>() : fIDResults(<span class="stringliteral">&quot;KVIdentificationResult&quot;</span>, 5)</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;{</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;   <span class="comment">//default ctor.</span></div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;   <a class="code" href="classKVReconstructedNucleus.html#aa2a59c5233f1e1311ae3a101b8343538">init</a>();</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;}</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;</div><div class="line"><a name="l00118"></a><span class="lineno"><a class="line" href="classKVReconstructedNucleus.html#a7e9d1ce3bcae2e80d4ec9998a07decb8">  118</a></span>&#160;<a class="code" href="classKVReconstructedNucleus.html#a658008aa049a13c4b901ec58329d836a">KVReconstructedNucleus::KVReconstructedNucleus</a>(<span class="keyword">const</span> <a class="code" href="classKVReconstructedNucleus.html">KVReconstructedNucleus</a>&amp; obj)</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;   : <a class="code" href="classKVNucleus.html">KVNucleus</a>(), <a class="code" href="classKVReconstructedNucleus.html#a8bf22b6b8c63d4febee44dab9d5198e0">fIDResults</a>(<span class="stringliteral">&quot;KVIdentificationResult&quot;</span>, 5)</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;{</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;   <span class="comment">//copy ctor</span></div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;   <a class="code" href="classKVReconstructedNucleus.html#aa2a59c5233f1e1311ae3a101b8343538">init</a>();</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;<span class="preprocessor">#if ROOT_VERSION_CODE &gt;= ROOT_VERSION(3,4,0)</span></div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;   obj.<a class="code" href="classKVReconstructedNucleus.html#a529110755c7248eb8b30681d4454bed7">Copy</a>(*<span class="keyword">this</span>);</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;   ((<a class="code" href="classKVReconstructedNucleus.html">KVReconstructedNucleus</a>&amp;) obj).Copy(*<span class="keyword">this</span>);</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;}</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;KVReconstructedNucleus::~KVReconstructedNucleus()</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;{</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;   <span class="comment">//dtor</span></div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;   <span class="comment">// calls KVGroup::Reset() of the group in which this particle was detected</span></div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="classKVReconstructedNucleus.html#ae83b684ae5a330645677bd86db4e0caf">GetGroup</a>()) {</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;      <a class="code" href="classKVReconstructedNucleus.html#ae83b684ae5a330645677bd86db4e0caf">GetGroup</a>()-&gt;<a class="code" href="classKVGroup.html#add6bc2fea7023957d38c2e621f85ca74">Reset</a>();</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;   }</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;   <a class="code" href="classKVReconstructedNucleus.html#aa2a59c5233f1e1311ae3a101b8343538">init</a>();</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;}</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;<span class="keywordtype">void</span> KVReconstructedNucleus::Streamer(TBuffer&amp; R__b)</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;{</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;   <span class="comment">// Stream an object of class KVReconstructedNucleus.</span></div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;   <span class="comment">//Customized streamer.</span></div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;   UInt_t R__s, R__c;</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;   <span class="keywordflow">if</span> (R__b.IsReading()) {</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;      Version_t R__v = R__b.ReadVersion(&amp;R__s, &amp;R__c);</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;      <span class="keywordflow">if</span> (R__v &lt; 17) {</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;         <span class="comment">// Before v17, fIDResults was a static array: KVIdentificationResult fIDresults[5]</span></div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;         <span class="comment">// We convert this to the new TClonesArray format</span></div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;         KVNucleus::Streamer(R__b);</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;         <a class="code" href="classKVReconstructedNucleus.html#a903dafc7f507288bd0407803718475f5">fDetNames</a>.Streamer(R__b);</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;         <a class="code" href="classKVReconstructedNucleus.html#aaf999e61d798981e0362f519c07b6d4a">fIDTelName</a>.Streamer(R__b);</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;         <span class="keywordflow">if</span> (R__v &gt;= 16) {</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;            R__b &gt;&gt; <a class="code" href="classKVReconstructedNucleus.html#ac461adab70c95ee1badae3064318fef2">fNSegDet</a>;</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;            R__b &gt;&gt; <a class="code" href="classKVReconstructedNucleus.html#af7a910f9061bf8a4da8934c60a8910b9">fAnalStatus</a>;</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;         }</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;         R__b &gt;&gt; <a class="code" href="classKVReconstructedNucleus.html#a2585afc686b533fbe6bd8cff60e63073">fRealZ</a>;</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;         R__b &gt;&gt; <a class="code" href="classKVReconstructedNucleus.html#a5e31b825f37f9d210d34d2b56118e94f">fRealA</a>;</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;         R__b &gt;&gt; <a class="code" href="classKVReconstructedNucleus.html#ad11cde034966270d6b3c96a969b4ea9c">fTargetEnergyLoss</a>;</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;         <span class="keywordtype">int</span> R__i;</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;         <a class="code" href="classKVIdentificationResult.html">KVIdentificationResult</a> id_array[5];</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;         <span class="keywordflow">for</span> (R__i = 0; R__i &lt; 5; R__i++) {</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;            id_array[R__i].Streamer(R__b);</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;            id_array[R__i].<a class="code" href="classKVIdentificationResult.html#a40c40ad2e24a507458e1727701669310">Copy</a>(*<a class="code" href="classKVReconstructedNucleus.html#a52f50790b587156e0decd14f7aff78be">GetIdentificationResult</a>(R__i + 1));</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;         }</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;         R__b.CheckByteCount(R__s, R__c, KVReconstructedNucleus::IsA());</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;      } <span class="keywordflow">else</span></div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;         R__b.ReadClassBuffer(KVReconstructedNucleus::Class(), <span class="keyword">this</span>, R__v, R__s, R__c);</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;      <span class="comment">// if the multidetector object exists, update some informations</span></div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;      <span class="comment">// concerning the detectors etc. hit by this particle</span></div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="KVMultiDetArray_8cpp.html#a2554fcc03212b313926f80da25349ae5">gMultiDetArray</a>) {</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;         <a class="code" href="classKVReconstructedNucleus.html#a0829bc19970446f4e30ae82ff6d176a7">MakeDetectorList</a>();</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;         <span class="keywordflow">if</span> (<a class="code" href="classKVReconstructedNucleus.html#ae83b684ae5a330645677bd86db4e0caf">GetGroup</a>()) <a class="code" href="classKVReconstructedNucleus.html#ae83b684ae5a330645677bd86db4e0caf">GetGroup</a>()-&gt;<a class="code" href="classKVGroup.html#aa2112c5501a8059fe831ff73c17ce621">AddHit</a>(<span class="keyword">this</span>);</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;         <a class="code" href="classKVReconstructedNucleus.html#af1da5d70c9e9e15b2b66d90ecaa23fa9">fIDTelescope</a> = 0;</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;         <span class="keywordflow">if</span> (<a class="code" href="classKVReconstructedNucleus.html#aaf999e61d798981e0362f519c07b6d4a">fIDTelName</a> != <span class="stringliteral">&quot;&quot;</span>) <a class="code" href="classKVReconstructedNucleus.html#af1da5d70c9e9e15b2b66d90ecaa23fa9">fIDTelescope</a> = <a class="code" href="KVMultiDetArray_8cpp.html#a2554fcc03212b313926f80da25349ae5">gMultiDetArray</a>-&gt;<a class="code" href="classKVMultiDetArray.html#ad915cf18454f95b852e13d3816a51abf">GetIDTelescope</a>(<a class="code" href="classKVReconstructedNucleus.html#aaf999e61d798981e0362f519c07b6d4a">fIDTelName</a>.Data());</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;         TIter next_det(&amp;<a class="code" href="classKVReconstructedNucleus.html#a598739f023dc0e3ca7777aa8f5a8e873">fDetList</a>);</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;         <a class="code" href="classKVDetector.html">KVDetector</a>* det;</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;         <span class="keywordflow">while</span> ((det = (<a class="code" href="classKVDetector.html">KVDetector</a>*)next_det())) {</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;            <span class="keywordflow">if</span> (R__v &lt; 16) <a class="code" href="classKVReconstructedNucleus.html#ac461adab70c95ee1badae3064318fef2">fNSegDet</a> += det-&gt;<a class="code" href="classKVDetector.html#ab9445c8f26f4e4ad0fce600f5fb6eb28">GetSegment</a>();  <span class="comment">// fNSegDet/fAnalStatus non-persistent before v.16</span></div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;            det-&gt;<a class="code" href="classKVDetector.html#adcc95d176097e864da9e39d225c5ba4f">AddHit</a>(<span class="keyword">this</span>);</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;            det-&gt;<a class="code" href="classKVDetector.html#aebf616ebf7589ceff2c36b9e014b4757">SetAnalysed</a>();</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;            <span class="comment">//modify detector&#39;s counters depending on particle&#39;s identification state</span></div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classKVReconstructedNucleus.html#a7dc06514cd3bba95e10241d743d9c74d">IsIdentified</a>())</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;               det-&gt;<a class="code" href="classKVDetector.html#a0bd4ac1b0d97b99a53f3b608625ffef5">IncrementIdentifiedParticles</a>();</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;            <span class="keywordflow">else</span></div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;               det-&gt;<a class="code" href="classKVDetector.html#a2453589a9a3884097d22c60321cb0483">IncrementUnidentifiedParticles</a>();</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;         }</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;      }</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;      R__b.WriteClassBuffer(KVReconstructedNucleus::Class(), <span class="keyword">this</span>);</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;   }</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;}</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;</div><div class="line"><a name="l00213"></a><span class="lineno"><a class="line" href="classKVReconstructedNucleus.html#a51ea7eeb7f992dd3cc261f2ca24bd8b7">  213</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classKVReconstructedNucleus.html#a51ea7eeb7f992dd3cc261f2ca24bd8b7">KVReconstructedNucleus::Print</a>(Option_t*)<span class="keyword"> const</span></div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;<span class="keyword"></span>{</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;   <span class="keywordtype">int</span> ndets = <a class="code" href="classKVReconstructedNucleus.html#a1f33be9dc3a0edd79e7a6a0d1f28dfb2">GetNumDet</a>();</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;   <span class="keywordflow">if</span> (ndets) {</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = ndets - 1; i &gt;= 0; i--) {</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;         <a class="code" href="classKVDetector.html">KVDetector</a>* det = <a class="code" href="classKVReconstructedNucleus.html#ab82a33c7e33b768613f289a0f0e554ac">GetDetector</a>(i);</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;         <span class="keywordflow">if</span> (det) det-&gt;<a class="code" href="classKVDetector.html#af044a7fef3d1b909bd924479c8a410dc">Print</a>(<span class="stringliteral">&quot;data&quot;</span>);</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;      }</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 1; i &lt;= <a class="code" href="classKVReconstructedNucleus.html#a4c884fe876031e0266aa83009c2240b6">GetNumberOfIdentificationResults</a>(); i++) {</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;         <a class="code" href="classKVIdentificationResult.html">KVIdentificationResult</a>* idr = <span class="keyword">const_cast&lt;</span><a class="code" href="classKVReconstructedNucleus.html">KVReconstructedNucleus</a>*<span class="keyword">&gt;</span>(<span class="keyword">this</span>)-&gt;<a class="code" href="classKVReconstructedNucleus.html#a52f50790b587156e0decd14f7aff78be">GetIdentificationResult</a>(i);</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;         <span class="keywordflow">if</span> (idr-&gt;<a class="code" href="classKVIdentificationResult.html#a05f516b0194ba311b101f8b796a94173">IDattempted</a>) idr-&gt;<a class="code" href="classKVIdentificationResult.html#a38ba4ea0908dd61e48428a0decfa327c">Print</a>();</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;      }</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;   }</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="classKVReconstructedNucleus.html#a8c9249feead1176572f38dd5da4ca3cb">GetStoppingDetector</a>()) cout &lt;&lt; <span class="stringliteral">&quot;STOPPED IN : &quot;</span> &lt;&lt;</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;                                      <a class="code" href="classKVReconstructedNucleus.html#a8c9249feead1176572f38dd5da4ca3cb">GetStoppingDetector</a>()-&gt;GetName() &lt;&lt; endl;</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="classKVReconstructedNucleus.html#a7dc06514cd3bba95e10241d743d9c74d">IsIdentified</a>()) {</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classKVReconstructedNucleus.html#ade54f876b9edf3e9ac5623403a3b266c">GetIdentifyingTelescope</a>()) cout &lt;&lt; <span class="stringliteral">&quot;IDENTIFIED IN : &quot;</span> &lt;&lt;</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;                                             <a class="code" href="classKVReconstructedNucleus.html#ade54f876b9edf3e9ac5623403a3b266c">GetIdentifyingTelescope</a>()-&gt;GetName() &lt;&lt; endl;</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;      cout &lt;&lt; <span class="stringliteral">&quot; =======&gt; &quot;</span>;</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;      cout &lt;&lt; <span class="stringliteral">&quot; Z=&quot;</span> &lt;&lt; <a class="code" href="classKVNucleus.html#ae9060d423b1a4a895e1305cc31631127">GetZ</a>() &lt;&lt; <span class="stringliteral">&quot; A=&quot;</span> &lt;&lt; <a class="code" href="classKVNucleus.html#a5d1a5c1b9ea016d11b9b4bd803c3a8c4">GetA</a>();</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classKVReconstructedNucleus.html#af4b1df3ef31220dd1c0b75929f617a2e">IsAMeasured</a>()) cout &lt;&lt; <span class="stringliteral">&quot; Areal=&quot;</span> &lt;&lt; <a class="code" href="classKVReconstructedNucleus.html#a4e2e49011cb7f1f5fab32137d235aec3">GetRealA</a>();</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;      <span class="keywordflow">else</span> cout &lt;&lt; <span class="stringliteral">&quot; Zreal=&quot;</span> &lt;&lt; <a class="code" href="classKVReconstructedNucleus.html#a3ef7eb98de0bea44a95d80b2c3f4873f">GetRealZ</a>();</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;      cout &lt;&lt; <span class="stringliteral">&quot;(unidentified)&quot;</span> &lt;&lt; endl;</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;   }</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="classKVReconstructedNucleus.html#a52ea2416aca1cde6a5e881ae4df12717">IsCalibrated</a>()) {</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;      cout &lt;&lt; <span class="stringliteral">&quot; Total Energy = &quot;</span> &lt;&lt; <a class="code" href="classKVParticle.html#a4ee1e4204aed7301503f32e0b542781e">GetEnergy</a>() &lt;&lt; <span class="stringliteral">&quot; MeV,  Theta=&quot;</span> &lt;&lt; <a class="code" href="classKVParticle.html#a37d725bbc656e6765d0a5eced52bc546">GetTheta</a>() &lt;&lt; <span class="stringliteral">&quot; Phi=&quot;</span> &lt;&lt; <a class="code" href="classKVParticle.html#a71cee813f08cc41e8aa141c1e5df32db">GetPhi</a>() &lt;&lt; endl;</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;      cout &lt;&lt; <span class="stringliteral">&quot;    Target energy loss correction :  &quot;</span> &lt;&lt; <a class="code" href="classKVReconstructedNucleus.html#a29cc65d62e1cc4fe7dd62da20d80e15a">GetTargetEnergyLoss</a>() &lt;&lt; <span class="stringliteral">&quot; MeV&quot;</span> &lt;&lt; endl;</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;      cout &lt;&lt; <span class="stringliteral">&quot;(uncalibrated)&quot;</span> &lt;&lt; endl;</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;   }</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;   cout &lt;&lt; <span class="stringliteral">&quot;RECONSTRUCTION STATUS : &quot;</span> &lt;&lt; endl;</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;   <span class="keywordflow">switch</span> (<a class="code" href="classKVReconstructedNucleus.html#a9372e92ada83f8277e6a2101da7e7ccf">GetStatus</a>()) {</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="classKVReconstructedNucleus.html#a225bc41a3152a3f98c19676bc9f09bcfa2a9e7ad5e6c7f973f1e127df5384995e">kStatusOK</a>:</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;         cout &lt;&lt;</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;              <span class="stringliteral">&quot;Particle alone in group, or identification independently of other&quot;</span></div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;              &lt;&lt; endl;</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;         cout &lt;&lt; <span class="stringliteral">&quot;particles in group is directly possible.&quot;</span> &lt;&lt; endl;</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="classKVReconstructedNucleus.html#a225bc41a3152a3f98c19676bc9f09bcfafa07abf430979404ec72497bd656189c">kStatusOKafterSub</a>:</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;         cout &lt;&lt;</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;              <span class="stringliteral">&quot;Particle reconstructed after identification of others in group&quot;</span></div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;              &lt;&lt; endl;</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;         cout &lt;&lt;</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;              <span class="stringliteral">&quot;and subtraction of their calculated energy losses in common detectors.&quot;</span></div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;              &lt;&lt; endl;</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="classKVReconstructedNucleus.html#a225bc41a3152a3f98c19676bc9f09bcfa23e77bb7c1a77d57466580ca201103cf">kStatusOKafterShare</a>:</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;         cout &lt;&lt;</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;              <span class="stringliteral">&quot;Particle identification estimated after arbitrary sharing of&quot;</span></div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;              &lt;&lt; endl;</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;         cout &lt;&lt;</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;              <span class="stringliteral">&quot;energy lost in common detectors between several reconstructed particles.&quot;</span></div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;              &lt;&lt; endl;</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="classKVReconstructedNucleus.html#a225bc41a3152a3f98c19676bc9f09bcfa493159641f838af8b403755f98144f7c">kStatusStopFirstStage</a>:</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;         cout &lt;&lt;</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;              <span class="stringliteral">&quot;Particle stopped in first stage of telescope. Estimation of minimum Z.&quot;</span></div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;              &lt;&lt; endl;</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="classKVReconstructedNucleus.html#a225bc41a3152a3f98c19676bc9f09bcfaf62c208cd36657fe89f2adde45f661e7">kStatusPileupDE</a>:</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;         cout &lt;&lt;</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;              <span class="stringliteral">&quot;Undetectable pile-up in first member of identifying telesscope (apparent status=OK).&quot;</span></div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;              &lt;&lt; endl;</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;         cout &lt;&lt; <span class="stringliteral">&quot;Would lead to incorrect identification by DE-E method (Z and/or A overestimated).&quot;</span></div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;              &lt;&lt; endl;</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;      <span class="keywordflow">case</span> <a class="code" href="classKVReconstructedNucleus.html#a225bc41a3152a3f98c19676bc9f09bcfa7391cd71d9354f5de36b7d012975fdb2">kStatusPileupGhost</a>:</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;         cout &lt;&lt;</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;              <span class="stringliteral">&quot;Undetectable ghost particle in filtered simulation.&quot;</span></div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;              &lt;&lt; endl;</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;         cout &lt;&lt; <span class="stringliteral">&quot;Another particle passed through all of the same detectors (pile-up).&quot;</span></div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;              &lt;&lt; endl;</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;      <span class="keywordflow">default</span>:</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;         cout &lt;&lt; <a class="code" href="classKVReconstructedNucleus.html#a9372e92ada83f8277e6a2101da7e7ccf">GetStatus</a>() &lt;&lt; endl;</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;         <span class="keywordflow">break</span>;</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;   }</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="classKVParticle.html#a32a39659542dbdd65c691f70524e4ea4">GetParameters</a>()-&gt;GetNpar()) <a class="code" href="classKVParticle.html#a32a39659542dbdd65c691f70524e4ea4">GetParameters</a>()-&gt;<a class="code" href="classKVNameValueList.html#a02561d65b153400e421977aa45d78dcb">Print</a>();</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;}</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;<span class="preprocessor">#if ROOT_VERSION_CODE &gt;= ROOT_VERSION(3,4,0)</span></div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;</div><div class="line"><a name="l00312"></a><span class="lineno"><a class="line" href="classKVReconstructedNucleus.html#a529110755c7248eb8b30681d4454bed7">  312</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classKVReconstructedNucleus.html#a529110755c7248eb8b30681d4454bed7">KVReconstructedNucleus::Copy</a>(TObject&amp; obj) <span class="keyword">const</span></div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;<span class="keywordtype">void</span> <a class="code" href="classKVReconstructedNucleus.html#a529110755c7248eb8b30681d4454bed7">KVReconstructedNucleus::Copy</a>(TObject&amp; obj)</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;{</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;   <span class="comment">//</span></div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;   <span class="comment">//Copy this to obj</span></div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;   <span class="comment">//</span></div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;   <a class="code" href="classKVNucleus.html#aa42f8a49ffe37c71784fc60cfdf1d2e9">KVNucleus::Copy</a>(obj);</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;   ((<a class="code" href="classKVReconstructedNucleus.html">KVReconstructedNucleus</a>&amp;) obj).SetIdentifyingTelescope(<a class="code" href="classKVReconstructedNucleus.html#ade54f876b9edf3e9ac5623403a3b266c">GetIdentifyingTelescope</a>());</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;   ((<a class="code" href="classKVReconstructedNucleus.html">KVReconstructedNucleus</a>&amp;) obj).fDetNames = <a class="code" href="classKVReconstructedNucleus.html#a903dafc7f507288bd0407803718475f5">fDetNames</a>;</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;   ((<a class="code" href="classKVReconstructedNucleus.html">KVReconstructedNucleus</a>&amp;) obj).SetRealZ(<a class="code" href="classKVReconstructedNucleus.html#a3ef7eb98de0bea44a95d80b2c3f4873f">GetRealZ</a>());</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;   ((<a class="code" href="classKVReconstructedNucleus.html">KVReconstructedNucleus</a>&amp;) obj).SetRealA(<a class="code" href="classKVReconstructedNucleus.html#a4e2e49011cb7f1f5fab32137d235aec3">GetRealA</a>());</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;   ((<a class="code" href="classKVReconstructedNucleus.html">KVReconstructedNucleus</a>&amp;) obj).SetTargetEnergyLoss(<a class="code" href="classKVReconstructedNucleus.html#a29cc65d62e1cc4fe7dd62da20d80e15a">GetTargetEnergyLoss</a>());</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;}</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;</div><div class="line"><a name="l00336"></a><span class="lineno"><a class="line" href="classKVReconstructedNucleus.html#ad6521fe731a8dd967bf4fa55bcd76177">  336</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classKVReconstructedNucleus.html#ad6521fe731a8dd967bf4fa55bcd76177">KVReconstructedNucleus::Clear</a>(Option_t* opt)</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;{</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;   <span class="comment">//Reset nucleus. Calls KVNucleus::Clear.</span></div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;   <span class="comment">//Calls KVGroup::Reset for the group where it was reconstructed.</span></div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;   <a class="code" href="classKVNucleus.html#a0f37b7c776b5f50bc58773534e815a34">KVNucleus::Clear</a>(opt);</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="classKVReconstructedNucleus.html#ae83b684ae5a330645677bd86db4e0caf">GetGroup</a>())</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;      <a class="code" href="classKVReconstructedNucleus.html#ae83b684ae5a330645677bd86db4e0caf">GetGroup</a>()-&gt;<a class="code" href="classKVGroup.html#add6bc2fea7023957d38c2e621f85ca74">Reset</a>();</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;   <a class="code" href="classKVReconstructedNucleus.html#a598739f023dc0e3ca7777aa8f5a8e873">fDetList</a>.<a class="code" href="classKVSeqCollection.html#a5edbe1ce090e93f70da107c1dc5abbe1">Clear</a>();</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;   <a class="code" href="classKVReconstructedNucleus.html#a8bf22b6b8c63d4febee44dab9d5198e0">fIDResults</a>.Clear(<span class="stringliteral">&quot;C&quot;</span>);</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;   <a class="code" href="classKVReconstructedNucleus.html#aa2a59c5233f1e1311ae3a101b8343538">init</a>();</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;}</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;</div><div class="line"><a name="l00358"></a><span class="lineno"><a class="line" href="classKVReconstructedNucleus.html#acee860c82ffaf63965a4ab379a9f9575">  358</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classKVReconstructedNucleus.html#acee860c82ffaf63965a4ab379a9f9575">KVReconstructedNucleus::AddDetector</a>(<a class="code" href="classKVDetector.html">KVDetector</a>* det)</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;{</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;   <span class="comment">//Add a detector to the list of those through which the particle passed.</span></div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;   <span class="comment">//Put reference to detector into fDetectors array, increase number of detectors by one.</span></div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;   <span class="comment">//As this is only used in initial particle reconstruction, we add 1 unidentified particle to the detector.</span></div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;   <span class="comment">// Creates KVHashList fDetList in case it does not exist.</span></div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;   <span class="comment">//add name of detector to fDetNames</span></div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;   <a class="code" href="classKVReconstructedNucleus.html#a903dafc7f507288bd0407803718475f5">fDetNames</a> += det-&gt;GetName();</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;   <a class="code" href="classKVReconstructedNucleus.html#a903dafc7f507288bd0407803718475f5">fDetNames</a> += <span class="stringliteral">&quot;/&quot;</span>;</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;   <span class="comment">// store pointer to detector</span></div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;   <a class="code" href="classKVReconstructedNucleus.html#a598739f023dc0e3ca7777aa8f5a8e873">fDetList</a>.<a class="code" href="classKVSeqCollection.html#ad8572701209c97af7ed6e2fd72978a6b">Add</a>(det);</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;   <span class="keywordflow">if</span> (det-&gt;<a class="code" href="classKVDetector.html#aba8fb091c9f1f6dcef8fbca1236d2b63">IsDetecting</a>()) {</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;      <span class="comment">//add segmentation index of detector to total segmentation index of particle</span></div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;      <a class="code" href="classKVReconstructedNucleus.html#ac461adab70c95ee1badae3064318fef2">fNSegDet</a> += det-&gt;<a class="code" href="classKVDetector.html#ab9445c8f26f4e4ad0fce600f5fb6eb28">GetSegment</a>();</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;      <span class="comment">//add 1 unidentified particle to the detector</span></div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;      det-&gt;<a class="code" href="classKVDetector.html#a2453589a9a3884097d22c60321cb0483">IncrementUnidentifiedParticles</a>();</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;   }</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;</div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;}</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;</div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;</div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;</div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;</div><div class="line"><a name="l00395"></a><span class="lineno"><a class="line" href="classKVReconstructedNucleus.html#a0a342534af0ba910c82df739924da30c">  395</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classKVReconstructedNucleus.html#a0a342534af0ba910c82df739924da30c">KVReconstructedNucleus::Reconstruct</a>(<a class="code" href="classKVDetector.html">KVDetector</a>* kvd)</div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;{</div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;   <span class="comment">//Reconstruction of a detected nucleus from the successive energy losses</span></div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;   <span class="comment">//measured in a series of detectors/telescopes.</span></div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;   <span class="comment">//</span></div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;   <span class="comment">//Starting from detector *kvd, collect information from all detectors placed directly</span></div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;   <span class="comment">//in front of *kvd (kvd-&gt;GetAlignedDetectors()),</span></div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;   <span class="comment">//these are the detectors the particle has passed through.</span></div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;   <span class="comment">//</span></div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;   <span class="comment">//Each one is added to the particle&#39;s list (KVReconstructedNucleus::AddDetector), and,</span></div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;   <span class="comment">//if it is not an unsegmented detector, it is marked as having been &quot;analysed&quot;</span></div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;   <span class="comment">//(KVDetector::SetAnalysed) in order to stop it being considered as a starting point for another</span></div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;   <span class="comment">//particle reconstruction.</span></div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;   <a class="code" href="classKVReconstructedNucleus.html#ac461adab70c95ee1badae3064318fef2">fNSegDet</a> = 0;</div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;   <a class="code" href="classKVParticle.html#a9f310fb346e582c66d7f640c0e6ae87e">SetParameter</a>(<span class="stringliteral">&quot;ARRAY&quot;</span>, kvd-&gt;<a class="code" href="classKVDetector.html#a99b4e60ca22d148781ef3d20416f7e17">GetNameOfArray</a>());</div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;   <span class="comment">//get list of detectors through which particle passed</span></div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;   <span class="keywordflow">if</span> (kvd-&gt;<a class="code" href="classKVDetector.html#a36c14085e0ec80f25c1bf8fd47e1232f">GetGroup</a>()) {</div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;      TList* aligned = kvd-&gt;<a class="code" href="classKVDetector.html#ac60bd4797fc7ccdd07bfd32742ed50bc">GetAlignedDetectors</a>();</div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;      <span class="keywordflow">if</span> (aligned) {</div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;</div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;         TIter next_aligned(aligned);</div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;         <a class="code" href="classKVDetector.html">KVDetector</a>* d;</div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;         <span class="keywordflow">while</span> ((d = (<a class="code" href="classKVDetector.html">KVDetector</a>*) next_aligned())) {</div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;            <a class="code" href="classKVReconstructedNucleus.html#acee860c82ffaf63965a4ab379a9f9575">AddDetector</a>(d);</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;            d-&gt;<a class="code" href="classKVDetector.html#adcc95d176097e864da9e39d225c5ba4f">AddHit</a>(<span class="keyword">this</span>);  <span class="comment">// add particle to list of particles hitting detector</span></div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;            d-&gt;<a class="code" href="classKVDetector.html#aebf616ebf7589ceff2c36b9e014b4757">SetAnalysed</a>(kTRUE);   <span class="comment">//cannot be used to seed another particle</span></div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;         }</div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;      }</div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;      kvd-&gt;<a class="code" href="classKVDetector.html#a36c14085e0ec80f25c1bf8fd47e1232f">GetGroup</a>()-&gt;<a class="code" href="classKVGroup.html#aa2112c5501a8059fe831ff73c17ce621">AddHit</a>(<span class="keyword">this</span>);</div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;   }</div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;}</div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;</div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;</div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;</div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;</div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;</div><div class="line"><a name="l00440"></a><span class="lineno"><a class="line" href="classKVReconstructedNucleus.html#ac4b7986f3b92de584fc4bf48493326e3">  440</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classKVReconstructedNucleus.html#ac4b7986f3b92de584fc4bf48493326e3">KVReconstructedNucleus::Identify</a>()</div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;{</div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;   <span class="comment">// Try to identify this nucleus by calling the Identify() function of each</span></div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;   <span class="comment">// ID telescope crossed by it, starting with the telescope where the particle stopped, in order</span></div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;   <span class="comment">//      -  only attempt identification in ID telescopes containing the stopping detector.</span></div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;   <span class="comment">//      -  only telescopes which have been correctly initialised for the current run are used,</span></div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;   <span class="comment">//         i.e. those for which KVIDTelescope::IsReadyForID() returns kTRUE.</span></div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;   <span class="comment">// This continues until a successful identification is achieved or there are no more ID telescopes to try.</span></div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;   <span class="comment">// The identification code corresponding to the identifying telescope is set as the identification code of the particle.</span></div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;</div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;</div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;   <a class="code" href="classKVList.html">KVList</a>* idt_list = <a class="code" href="classKVReconstructedNucleus.html#a8c9249feead1176572f38dd5da4ca3cb">GetStoppingDetector</a>()-&gt;<a class="code" href="classKVDetector.html#a338f814acba30617cecc483780da5e8c">GetAlignedIDTelescopes</a>();</div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;   <span class="keywordflow">if</span> (idt_list &amp;&amp; idt_list-&gt;<a class="code" href="classKVSeqCollection.html#a664e089215412018fbd8fad91a5a9f2b">GetSize</a>() &gt; 0) {</div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;</div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;      <a class="code" href="classKVIDTelescope.html">KVIDTelescope</a>* idt;</div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;      TIter next(idt_list);</div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;      Int_t idnumber = 1;</div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;      Int_t n_success_id = 0;<span class="comment">//number of successful identifications</span></div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;      <span class="keywordflow">while</span> ((idt = (<a class="code" href="classKVIDTelescope.html">KVIDTelescope</a>*) next())) {</div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;         <a class="code" href="classKVIdentificationResult.html">KVIdentificationResult</a>* IDR = <a class="code" href="classKVReconstructedNucleus.html#a52f50790b587156e0decd14f7aff78be">GetIdentificationResult</a>(idnumber++);</div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;</div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;</div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;         <span class="keywordflow">if</span> (idt-&gt;<a class="code" href="classKVIDTelescope.html#a062c3bf3961e074aca8f0bf2ba8a1a6d">IsReadyForID</a>()) { <span class="comment">// is telescope able to identify for this run ?</span></div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;</div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;            IDR-&gt;<a class="code" href="classKVIdentificationResult.html#a05f516b0194ba311b101f8b796a94173">IDattempted</a> = kTRUE;</div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;            idt-&gt;<a class="code" href="classKVIDTelescope.html#a288fc0f4f235ebb9dec51eb94dc92daf">Identify</a>(IDR);</div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;</div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;            <span class="keywordflow">if</span> (IDR-&gt;<a class="code" href="classKVIdentificationResult.html#a27a4322a2ac797a813148cb63af3339c">IDOK</a>) n_success_id++;</div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;         } <span class="keywordflow">else</span></div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;            IDR-&gt;<a class="code" href="classKVIdentificationResult.html#a05f516b0194ba311b101f8b796a94173">IDattempted</a> = kFALSE;</div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;</div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;         <span class="keywordflow">if</span> (n_success_id &lt; 1 &amp;&amp;</div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;               ((!IDR-&gt;<a class="code" href="classKVIdentificationResult.html#a05f516b0194ba311b101f8b796a94173">IDattempted</a>) || (IDR-&gt;<a class="code" href="classKVIdentificationResult.html#a05f516b0194ba311b101f8b796a94173">IDattempted</a> &amp;&amp; !IDR-&gt;<a class="code" href="classKVIdentificationResult.html#a27a4322a2ac797a813148cb63af3339c">IDOK</a>))) {</div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;            <span class="comment">// the particle is less identifiable than initially thought</span></div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;            <span class="comment">// we may have to wait for secondary identification</span></div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;            Int_t nseg = <a class="code" href="classKVReconstructedNucleus.html#aa91c50893bc2883353470b5ccb996b34">GetNSegDet</a>();</div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;            <a class="code" href="classKVReconstructedNucleus.html#a43dec454bb300756ea7ab4dce812f9c0">SetNSegDet</a>(TMath::Max(nseg - 1, 0));</div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;            <span class="comment">//if there are other unidentified particles in the group and NSegDet is &lt; 2</span></div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;            <span class="comment">//then exact status depends on segmentation of the other particles : reanalyse</span></div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="classKVReconstructedNucleus.html#aa91c50893bc2883353470b5ccb996b34">GetNSegDet</a>() &lt; 2 &amp;&amp; <a class="code" href="classKVReconstructedNucleus.html#a3e88c8d36d75796d307c8547c7e39fc9">GetNUnidentifiedInGroup</a>(<a class="code" href="classKVReconstructedNucleus.html#ae83b684ae5a330645677bd86db4e0caf">GetGroup</a>()) &gt; 1) {</div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;               <a class="code" href="classKVReconstructedNucleus.html#ae3ec6de68771df778fc503f33e6bc815">AnalyseParticlesInGroup</a>(<a class="code" href="classKVReconstructedNucleus.html#ae83b684ae5a330645677bd86db4e0caf">GetGroup</a>());</div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;               <span class="keywordflow">return</span>;</div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;            }</div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;            <span class="comment">//if NSegDet = 0 it&#39;s hopeless</span></div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;            <span class="keywordflow">if</span> (!<a class="code" href="classKVReconstructedNucleus.html#aa91c50893bc2883353470b5ccb996b34">GetNSegDet</a>()) {</div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;               <a class="code" href="classKVReconstructedNucleus.html#ae3ec6de68771df778fc503f33e6bc815">AnalyseParticlesInGroup</a>(<a class="code" href="classKVReconstructedNucleus.html#ae83b684ae5a330645677bd86db4e0caf">GetGroup</a>());</div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;               <span class="keywordflow">return</span>;</div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;            }</div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;         }</div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;      }</div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;   }</div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;}</div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;</div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;</div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;</div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;</div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;</div><div class="line"><a name="l00544"></a><span class="lineno"><a class="line" href="classKVReconstructedNucleus.html#ae3ec6de68771df778fc503f33e6bc815">  544</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classKVReconstructedNucleus.html#ae3ec6de68771df778fc503f33e6bc815">KVReconstructedNucleus::AnalyseParticlesInGroup</a>(<a class="code" href="classKVGroup.html">KVGroup</a>* grp)</div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;{</div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;   <span class="comment">//The short description of this method is:</span></div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;   <span class="comment">//</span></div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;   <span class="comment">//      Here we analyse all the particles stopping in this group in order to</span></div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;   <span class="comment">//      determine &#39;KVReconstructedNucleus::GetStatus()&#39; for each one.</span></div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;   <span class="comment">//      This is a sort of &#39;first-order&#39; coherency analysis necessary prior to</span></div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;   <span class="comment">//      attempting particle identification.</span></div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;   <span class="comment">//</span></div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;   <span class="comment">//The long description of this method is:</span></div><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;   <span class="comment">//</span></div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;   <span class="comment">//Analyse the different particles reconstructed in this group in order to</span></div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;   <span class="comment">//establish the strategy necessary to fully reconstruct each one</span></div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;   <span class="comment">//In a group with &gt;=3-member telescopes, the maximum number of particles which may be</span></div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;   <span class="comment">//reconstructed correctly is equal to the number of telescopes constituting the</span></div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;   <span class="comment">//last layer of the group if all particles stop in the last detector of the last</span></div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;   <span class="comment">//layer.</span></div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;   <span class="comment">//i.e. in rings 4-9 (ChIo-Si-CsI telescopes) any group can detect up to 4 particles</span></div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;   <span class="comment">//all going through to the CsI i.e. either light particles identified from CsI R-L</span></div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;   <span class="comment">//matrices or fragments identified from Si-CsI matrices.</span></div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;   <span class="comment">//</span></div><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;   <span class="comment">//Any particle detected in a group on its own is perfectly fine (fAnalStatus=0).</span></div><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;   <span class="comment">//</span></div><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;   <span class="comment">//Any particle detected in the final layer of a &quot;3-detector layer&quot; group</span></div><div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;   <span class="comment">//(i.e. ChIo-Si-CsI) is perfectly fine (fAnalStatus=0).</span></div><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;   <span class="comment">//</span></div><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;   <span class="comment">//A particle stopping in the 2nd layer of a &quot;3-detector layer&quot; group (i.e. in Si)</span></div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;   <span class="comment">//can be reconstructed if all the other particles in its group stop in the 3rd</span></div><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;   <span class="comment">//layer (i.e. CsI), once the other particles have been reconstructed and their</span></div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;   <span class="comment">//calculated energy loss in the ChIo has been subtracted from the measured value</span></div><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;   <span class="comment">//(fAnalStatus=1).</span></div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;   <span class="comment">//</span></div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;   <span class="comment">//It&#39;s a question of &quot;segmented&quot; or &quot;independent&quot; detectors. The ChIo&#39;s are not</span></div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;   <span class="comment">//&quot;independent&quot; because a particle passing the ChIo can hit several detectors behind</span></div><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;   <span class="comment">//it, whereas any particle passing a given Si can only hit the CsI directly behind</span></div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;   <span class="comment">//that Si, because the Si (and CsI) are more &quot;segmented&quot; than the ChIo&#39;s.</span></div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;   <span class="comment">//Soooo...any particle crossing at least 2 &quot;independent&quot; detectors can be identified</span></div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;   <span class="comment">//sans probleme. In fact CsI count for 2 independent detectors themselves, because</span></div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;   <span class="comment">//light particles can be identified just from CsI information i.e. no need for</span></div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;   <span class="comment">//&quot;delta-E&quot; signal. Unless of course the R-L attempt fails, at which moment the</span></div><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;   <span class="comment">//particle&#39;s AnalStatus may be changed and it may be up for reassessment in</span></div><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;   <span class="comment">//subsequent rounds of analysis.</span></div><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;   <span class="comment">//Particles hitting 0 independent detectors (I.e. stopped in ChIo)</span></div><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;   <span class="comment">//can not be reconstructed. Any particle hitting only 1 independent detector can</span></div><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;   <span class="comment">//be reconstructed if alone in the group i.e. no other particles or all others have</span></div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;   <span class="comment">//hit &gt;=2 independent detectors. If more than one particle in the same group only</span></div><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;   <span class="comment">//hit 1 independent detector, then one can only make a rough estimation of their</span></div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;   <span class="comment">//nature.</span></div><div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="classKVReconstructedNucleus.html#a3e88c8d36d75796d307c8547c7e39fc9">GetNUnidentifiedInGroup</a>(grp) &gt; 1) { <span class="comment">//if there is more than one unidentified particle in the group</span></div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;</div><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;      UShort_t n_nseg_1 = 0;</div><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;      <span class="keywordflow">if</span> (!grp-&gt;<a class="code" href="classKVGroup.html#a492627ae39f99e8628768916087cc65a">GetParticles</a>()) {</div><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;         ::Error(<span class="stringliteral">&quot;KVReconstructedNucleus::AnalyseParticlesInGroup&quot;</span>, <span class="stringliteral">&quot;No particles in group ?&quot;</span>);</div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;         <span class="keywordflow">return</span>;</div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;      }</div><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;      TIter next(grp-&gt;<a class="code" href="classKVGroup.html#a492627ae39f99e8628768916087cc65a">GetParticles</a>());</div><div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;      <a class="code" href="classKVReconstructedNucleus.html">KVReconstructedNucleus</a>* nuc;</div><div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;      <span class="comment">//loop over particles counting up different cases</span></div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;      <span class="keywordflow">while</span> ((nuc = (<a class="code" href="classKVReconstructedNucleus.html">KVReconstructedNucleus</a>*) next())) {</div><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;         <span class="comment">//ignore identified particles</span></div><div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;         <span class="keywordflow">if</span> (nuc-&gt;IsIdentified())</div><div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;            <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;</div><div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;         <span class="keywordflow">if</span> (nuc-&gt;GetNSegDet() &gt;= 2) {</div><div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;            <span class="comment">//all part.s crossing 2 or more independent detectors are fine</span></div><div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;            nuc-&gt;<a class="code" href="classKVReconstructedNucleus.html#a4dc82d00456c3e5a5267bbccada20844">SetStatus</a>(<a class="code" href="classKVReconstructedNucleus.html#a225bc41a3152a3f98c19676bc9f09bcfa2a9e7ad5e6c7f973f1e127df5384995e">KVReconstructedNucleus::kStatusOK</a>);</div><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;         } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (nuc-&gt;GetNSegDet() == 1) {</div><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;            <span class="comment">//only 1 independent detector hit =&gt; depends on what&#39;s in the rest</span></div><div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;            <span class="comment">//of the group</span></div><div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;            n_nseg_1++;</div><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;         } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;            <span class="comment">//part.s crossing 0 independent detectors (i.E. arret ChIo)</span></div><div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;            <span class="comment">//can not be reconstructed</span></div><div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;            nuc-&gt;SetStatus(<a class="code" href="classKVReconstructedNucleus.html#a225bc41a3152a3f98c19676bc9f09bcfa493159641f838af8b403755f98144f7c">KVReconstructedNucleus::kStatusStopFirstStage</a>);</div><div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;         }</div><div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;      }</div><div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;      next.Reset();</div><div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;      <span class="comment">//loop again, setting status</span></div><div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;      <span class="keywordflow">while</span> ((nuc = (<a class="code" href="classKVReconstructedNucleus.html">KVReconstructedNucleus</a>*) next())) {</div><div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;         <span class="keywordflow">if</span> (nuc-&gt;IsIdentified())</div><div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;            <span class="keywordflow">continue</span>;           <span class="comment">//ignore identified particles</span></div><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;</div><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;         <span class="keywordflow">if</span> (nuc-&gt;GetNSegDet() == 1) {</div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;            <span class="keywordflow">if</span> (n_nseg_1 == 1) {</div><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;               <span class="comment">//just the one ? then we can get it no problem</span></div><div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;               <span class="comment">//after identifying the others and subtracting their calculated</span></div><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;               <span class="comment">//energy losses from the &quot;dependent&quot;/&quot;non-segmented&quot; detector</span></div><div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;               <span class="comment">//(i.E. the ChIo)</span></div><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;               nuc-&gt;SetStatus(<a class="code" href="classKVReconstructedNucleus.html#a225bc41a3152a3f98c19676bc9f09bcfafa07abf430979404ec72497bd656189c">KVReconstructedNucleus::kStatusOKafterSub</a>);</div><div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;            } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;               <span class="comment">//more than one ? then we can make some wild guess by sharing the</span></div><div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;               <span class="comment">//&quot;non-segmented&quot; (i.e. ChIo) contribution between them, but</span></div><div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;               <span class="comment">//I wouldn&#39;t trust it as far as I can spit</span></div><div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;               nuc-&gt;SetStatus(<a class="code" href="classKVReconstructedNucleus.html#a225bc41a3152a3f98c19676bc9f09bcfa23e77bb7c1a77d57466580ca201103cf">KVReconstructedNucleus::kStatusOKafterShare</a>);</div><div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;            }</div><div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;            <span class="comment">//one possibility remains: the particle may actually have stopped e.g.</span></div><div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;            <span class="comment">//in the DE detector of a DE-E telescope, in which case AnalStatus = 3</span></div><div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;            <span class="keywordflow">if</span> (nuc-&gt;GetIDTelescopes()-&gt;GetSize() == 0) {</div><div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;               <span class="comment">//no ID telescopes with which to identify particle</span></div><div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;               nuc-&gt;SetStatus(<a class="code" href="classKVReconstructedNucleus.html#a225bc41a3152a3f98c19676bc9f09bcfa493159641f838af8b403755f98144f7c">KVReconstructedNucleus::kStatusStopFirstStage</a>);</div><div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;            }</div><div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;         }</div><div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;      }</div><div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;   } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classKVReconstructedNucleus.html#a3e88c8d36d75796d307c8547c7e39fc9">GetNUnidentifiedInGroup</a>(grp) == 1) {</div><div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;      <span class="comment">//only one unidentified particle in group: if NSegDet&gt;=1 then it&#39;s OK</span></div><div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;</div><div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;      <span class="comment">//loop over particles looking for the unidentified one</span></div><div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;      TIter next(grp-&gt;<a class="code" href="classKVGroup.html#a492627ae39f99e8628768916087cc65a">GetParticles</a>());</div><div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;      <a class="code" href="classKVReconstructedNucleus.html">KVReconstructedNucleus</a>* nuc;</div><div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;      <span class="keywordflow">while</span> ((nuc = (<a class="code" href="classKVReconstructedNucleus.html">KVReconstructedNucleus</a>*) next()))</div><div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;         <span class="keywordflow">if</span> (!nuc-&gt;IsIdentified())</div><div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;</div><div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;      <span class="keywordflow">if</span> (nuc-&gt;GetNSegDet() &gt; 0) {</div><div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;         <span class="comment">//OK no problem</span></div><div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;         nuc-&gt;<a class="code" href="classKVReconstructedNucleus.html#a4dc82d00456c3e5a5267bbccada20844">SetStatus</a>(<a class="code" href="classKVReconstructedNucleus.html#a225bc41a3152a3f98c19676bc9f09bcfa2a9e7ad5e6c7f973f1e127df5384995e">KVReconstructedNucleus::kStatusOK</a>);</div><div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;         <span class="comment">//dead in the water</span></div><div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;         nuc-&gt;SetStatus(<a class="code" href="classKVReconstructedNucleus.html#a225bc41a3152a3f98c19676bc9f09bcfa493159641f838af8b403755f98144f7c">KVReconstructedNucleus::kStatusStopFirstStage</a>);</div><div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;      }</div><div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;      <span class="comment">//one possibility remains: the particle may actually have stopped e.g. in the 1st member</span></div><div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;      <span class="comment">//of a telescope, in which case AnalStatus = 3</span></div><div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;      <span class="keywordflow">if</span> (nuc-&gt;GetIDTelescopes()-&gt;GetSize() == 0) {</div><div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;         <span class="comment">//no ID telescopes with which to identify particle</span></div><div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;         nuc-&gt;SetStatus(<a class="code" href="classKVReconstructedNucleus.html#a225bc41a3152a3f98c19676bc9f09bcfa493159641f838af8b403755f98144f7c">KVReconstructedNucleus::kStatusStopFirstStage</a>);</div><div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;      }</div><div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;   }</div><div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;<span class="preprocessor">#ifdef KV_DEBUG</span></div><div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;   Info(<span class="stringliteral">&quot;AnalyseGroups&quot;</span>, <span class="stringliteral">&quot;OK after analysis of particles in groups&quot;</span>);</div><div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;}</div><div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;</div><div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;</div><div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;</div><div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;</div><div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;</div><div class="line"><a name="l00695"></a><span class="lineno"><a class="line" href="classKVReconstructedNucleus.html#a20fdf05449df9edca542e5a8f18f1e50">  695</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classKVReconstructedNucleus.html#a20fdf05449df9edca542e5a8f18f1e50">KVReconstructedNucleus::GetAnglesFromStoppingDetector</a>(Option_t* opt)</div><div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;{</div><div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;   <span class="comment">// Calculate angles theta and phi for reconstructed nucleus based</span></div><div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;   <span class="comment">// on detector in which it stopped*. The nucleus&#39;</span></div><div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;   <span class="comment">// momentum is set using these angles, its mass and its kinetic energy.</span></div><div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;   <span class="comment">// The (optional) option string can be &quot;random&quot; or &quot;mean&quot;.</span></div><div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;   <span class="comment">// If &quot;random&quot; (default) the angles are drawn at random between the</span></div><div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;   <span class="comment">// over the surface of the detector.</span></div><div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;   <span class="comment">// If &quot;mean&quot; the (theta,phi) position of the centre of the detector</span></div><div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;   <span class="comment">// is used to fix the nucleus&#39; direction.</span></div><div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;   <span class="comment">//</span></div><div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;   <span class="comment">// *unless the detector directly in front of the stopping detector has</span></div><div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;   <span class="comment">//  a smaller solid angle, in which case we use that one (because the</span></div><div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;   <span class="comment">//  particle had to pass through the smaller angular range defined by</span></div><div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;   <span class="comment">//  the DE-detector)</span></div><div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;</div><div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;   <span class="comment">//don&#39;t try if particle has no correctly defined energy</span></div><div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="classKVParticle.html#a4ee1e4204aed7301503f32e0b542781e">GetEnergy</a>() &lt;= 0.0)</div><div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;   <span class="keywordflow">if</span> (!<a class="code" href="classKVReconstructedNucleus.html#a8c9249feead1176572f38dd5da4ca3cb">GetStoppingDetector</a>())</div><div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;</div><div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;   <a class="code" href="classKVDetector.html">KVDetector</a>* angle_det = <a class="code" href="classKVReconstructedNucleus.html#a8c9249feead1176572f38dd5da4ca3cb">GetStoppingDetector</a>();</div><div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;   <span class="keywordflow">if</span> (angle_det-&gt;<a class="code" href="classKVDetector.html#ac631b3547c5dceac6882b6138cdaba00">GetNode</a>()-&gt;<a class="code" href="classKVGeoDetectorNode.html#ab46bf48b519e9b78a53d3a8cef668f6f">GetNDetsInFront</a>()) {</div><div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;      <a class="code" href="classKVDetector.html">KVDetector</a>* d = (<a class="code" href="classKVDetector.html">KVDetector</a>*)angle_det-&gt;<a class="code" href="classKVDetector.html#ac631b3547c5dceac6882b6138cdaba00">GetNode</a>()-&gt;<a class="code" href="classKVGeoDetectorNode.html#ac2dab061ac6d6d3b5d0c744afb6e7740">GetDetectorsInFront</a>()-&gt;<a class="code" href="classKVSeqCollection.html#a79e71dc3aba24a091398199d670b5837">First</a>();</div><div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;      <span class="keywordflow">if</span> (d-&gt;<a class="code" href="classKVPosition.html#abe44ed6ba5d44c3173d0ff22e981fa55">GetSolidAngle</a>() &lt; angle_det-&gt;<a class="code" href="classKVPosition.html#abe44ed6ba5d44c3173d0ff22e981fa55">GetSolidAngle</a>())</div><div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;         angle_det = d;</div><div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;   }</div><div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;   <span class="keywordflow">if</span> (!strcmp(opt, <span class="stringliteral">&quot;random&quot;</span>)) {</div><div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;      <span class="comment">//random angles</span></div><div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;      TVector3 dir = angle_det-&gt;<a class="code" href="classKVPosition.html#a1f2422675a97b3691c8ed99a654bfd4f">GetRandomDirection</a>(<span class="stringliteral">&quot;random&quot;</span>);</div><div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;      <a class="code" href="classKVParticle.html#a3d93f8bb12e37d184d074caca69dfb44">SetMomentum</a>(<a class="code" href="classKVParticle.html#a4ee1e4204aed7301503f32e0b542781e">GetEnergy</a>(), dir);</div><div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;      <span class="comment">//middle of telescope</span></div><div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;      TVector3 dir = angle_det-&gt;<a class="code" href="classKVPosition.html#af2398473f9dd269dc2254d6877c20716">GetDirection</a>();</div><div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;      <a class="code" href="classKVParticle.html#a3d93f8bb12e37d184d074caca69dfb44">SetMomentum</a>(<a class="code" href="classKVParticle.html#a4ee1e4204aed7301503f32e0b542781e">GetEnergy</a>(), dir);</div><div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;   }</div><div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;}</div><div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;</div><div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;</div><div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;</div><div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;</div><div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;</div><div class="line"><a name="l00752"></a><span class="lineno"><a class="line" href="classKVReconstructedNucleus.html#a1b7c1c65909b9715c7a759a5bfb5da44">  752</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classKVReconstructedNucleus.html#a1b7c1c65909b9715c7a759a5bfb5da44">KVReconstructedNucleus::Calibrate</a>()</div><div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;{</div><div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;   <span class="comment">//Calculate and set the energy of a (previously identified) reconstructed particle,</span></div><div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;   <span class="comment">//including an estimate of the energy loss in the target.</span></div><div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;   <span class="comment">//</span></div><div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;   <span class="comment">//Starting from the detector in which the particle stopped, we add up the</span></div><div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;   <span class="comment">//&#39;corrected&#39; energy losses in all of the detectors through which it passed.</span></div><div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;   <span class="comment">//Whenever possible, for detectors which are not calibrated or not working,</span></div><div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;   <span class="comment">//we calculate the energy loss. Measured &amp; calculated energy losses are also</span></div><div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;   <span class="comment">//compared for each detector, and may lead to new particles being seeded for</span></div><div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;   <span class="comment">//subsequent identification. This is done by KVIDTelescope::CalculateParticleEnergy().</span></div><div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;   <span class="comment">//</span></div><div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;   <span class="comment">//For particles whose energy before hitting the first detector in their path has been</span></div><div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;   <span class="comment">//calculated after this step we then add the calculated energy loss in the target,</span></div><div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;   <span class="comment">//using gMultiDetArray-&gt;GetTargetEnergyLossCorrection().</span></div><div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;</div><div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;   <a class="code" href="classKVIDTelescope.html">KVIDTelescope</a>* idt = <a class="code" href="classKVReconstructedNucleus.html#ade54f876b9edf3e9ac5623403a3b266c">GetIdentifyingTelescope</a>();</div><div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;   idt-&gt;<a class="code" href="classKVIDTelescope.html#a782a0aef92fca188d78aacd734daa6c0">CalculateParticleEnergy</a>(<span class="keyword">this</span>);</div><div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;   <span class="keywordflow">if</span> (idt-&gt;<a class="code" href="classKVIDTelescope.html#a9e5c4a9387bfdd72cce3f4b659e36abf">GetCalibStatus</a>() != <a class="code" href="classKVIDTelescope.html#a8c1eff10aff1a96f831b3ef045cdf331ada914c753214563d9a32bdc5f9e6d7ad">KVIDTelescope::kCalibStatus_NoCalibrations</a>) {</div><div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;      <a class="code" href="classKVReconstructedNucleus.html#a8fb014a392dbaa9e25856ea9352bc8a5">SetIsCalibrated</a>();</div><div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;      <span class="comment">//add correction for target energy loss - moving charged particles only!</span></div><div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;      Double_t E_targ = 0.;</div><div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classKVNucleus.html#ae9060d423b1a4a895e1305cc31631127">GetZ</a>() &amp;&amp; <a class="code" href="classKVParticle.html#a4ee1e4204aed7301503f32e0b542781e">GetEnergy</a>() &gt; 0) {</div><div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;         E_targ = <a class="code" href="KVMultiDetArray_8cpp.html#a2554fcc03212b313926f80da25349ae5">gMultiDetArray</a>-&gt;<a class="code" href="classKVMultiDetArray.html#a23bc007d119c7e180bd6a5286a05cfbf">GetTargetEnergyLossCorrection</a>(<span class="keyword">this</span>);</div><div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;         <a class="code" href="classKVReconstructedNucleus.html#a8db81d04943705c4a59a8f9d08236e1b">SetTargetEnergyLoss</a>(E_targ);</div><div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;      }</div><div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;      Double_t E_tot = <a class="code" href="classKVParticle.html#a4ee1e4204aed7301503f32e0b542781e">GetEnergy</a>() + E_targ;</div><div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;      <a class="code" href="classKVParticle.html#ad91ce7b02fb299867f789ed9eec4c291">SetEnergy</a>(E_tot);</div><div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;      <span class="comment">// set particle momentum from telescope dimensions (random)</span></div><div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;      <a class="code" href="classKVReconstructedNucleus.html#a20fdf05449df9edca542e5a8f18f1e50">GetAnglesFromStoppingDetector</a>();</div><div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;   }</div><div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;}</div><div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;</div><div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;</div><div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;</div><div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;</div><div class="line"><a name="l00792"></a><span class="lineno"><a class="line" href="classKVReconstructedNucleus.html#a0829bc19970446f4e30ae82ff6d176a7">  792</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classKVReconstructedNucleus.html#a0829bc19970446f4e30ae82ff6d176a7">KVReconstructedNucleus::MakeDetectorList</a>()</div><div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;{</div><div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;   <span class="comment">// Protected method, called when required to fill fDetList with pointers to</span></div><div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;   <span class="comment">// the detectors whose names are stored in fDetNames.</span></div><div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;   <span class="comment">// If gMultiDetArray=0x0, fDetList list will be empty.</span></div><div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;</div><div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;   <a class="code" href="classKVReconstructedNucleus.html#a598739f023dc0e3ca7777aa8f5a8e873">fDetList</a>.<a class="code" href="classKVSeqCollection.html#a5edbe1ce090e93f70da107c1dc5abbe1">Clear</a>();</div><div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;   <span class="keywordflow">if</span> (<a class="code" href="KVMultiDetArray_8cpp.html#a2554fcc03212b313926f80da25349ae5">gMultiDetArray</a>) <a class="code" href="KVMultiDetArray_8cpp.html#a2554fcc03212b313926f80da25349ae5">gMultiDetArray</a>-&gt;<a class="code" href="classKVMultiDetArray.html#a849e85bb6dbee9ba7f5d46158137bd49">FillDetectorList</a>(<span class="keyword">this</span>, &amp;<a class="code" href="classKVReconstructedNucleus.html#a598739f023dc0e3ca7777aa8f5a8e873">fDetList</a>, <a class="code" href="classKVReconstructedNucleus.html#a903dafc7f507288bd0407803718475f5">fDetNames</a>);</div><div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;}</div><div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;</div><div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;</div><div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;</div><div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;</div><div class="line"><a name="l00810"></a><span class="lineno"><a class="line" href="classKVReconstructedNucleus.html#a5aff056034d1c6cbcc1c339506a45163">  810</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classKVReconstructedNucleus.html#a5aff056034d1c6cbcc1c339506a45163">KVReconstructedNucleus::SetIdentification</a>(<a class="code" href="classKVIdentificationResult.html">KVIdentificationResult</a>* idr)</div><div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;{</div><div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;   <span class="comment">// Set identification of nucleus from informations in identification result object</span></div><div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;   <span class="comment">// The mass (A) information in KVIdentificationResult is only used if the mass</span></div><div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;   <span class="comment">// was measured as part of the identification. Otherwise the nucleus&#39; mass formula</span></div><div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;   <span class="comment">// will be used to calculate A from the measured Z.</span></div><div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;</div><div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;   <a class="code" href="classKVReconstructedNucleus.html#a0803855f21715d103c54bd6d4a865944">SetIDCode</a>(idr-&gt;<a class="code" href="classKVIdentificationResult.html#ac2c5bd2256c03125bbf2ea386d9975f9">IDcode</a>);</div><div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;   <a class="code" href="classKVReconstructedNucleus.html#abf0045dbdf91cab40330f31d09e9f4d6">SetZMeasured</a>(idr-&gt;<a class="code" href="classKVIdentificationResult.html#aec29f9b5d2345cb3bf44f2bdd213bbc1">Zident</a>);</div><div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;   <a class="code" href="classKVReconstructedNucleus.html#a1a6a0ae1878ac5df37cfafaede899340">SetAMeasured</a>(idr-&gt;<a class="code" href="classKVIdentificationResult.html#a8886575be80f2a09430412771e868e16">Aident</a>);</div><div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;   <a class="code" href="classKVNucleus.html#a6983e634af13af641a0d7f4725ca6521">SetZ</a>(idr-&gt;<a class="code" href="classKVIdentificationResult.html#ab9c910682f27824de0d9ecc64fe0af9b">Z</a>);</div><div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;   <span class="keywordflow">if</span> (idr-&gt;<a class="code" href="classKVIdentificationResult.html#a8886575be80f2a09430412771e868e16">Aident</a>) {</div><div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;      <a class="code" href="classKVNucleus.html#a5f711989f6f6a1c8d6faa0201fc67bca">SetA</a>(idr-&gt;<a class="code" href="classKVIdentificationResult.html#aaf673002ffbf729874578beb71147c3a">A</a>);</div><div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;      <a class="code" href="classKVReconstructedNucleus.html#a7a8adbc880fb38065a4234912a19a177">SetRealA</a>(idr-&gt;<a class="code" href="classKVIdentificationResult.html#a8b78ca5befdc2d9c7a71f6dd6c659f7e">PID</a>);</div><div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;   } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;      <a class="code" href="classKVReconstructedNucleus.html#ab6633c009bfb20f21144345d445be766">SetRealZ</a>(idr-&gt;<a class="code" href="classKVIdentificationResult.html#a8b78ca5befdc2d9c7a71f6dd6c659f7e">PID</a>);</div><div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;   }</div><div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;}</div><div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;</div><div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;</div><div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;</div><div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;</div><div class="line"><a name="l00835"></a><span class="lineno"><a class="line" href="classKVReconstructedNucleus.html#a54a6e71d2b5637b4227895540be3e755">  835</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="classKVReconstructedNucleus.html#a54a6e71d2b5637b4227895540be3e755">KVReconstructedNucleus::SubtractEnergyFromAllDetectors</a>()</div><div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;{</div><div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;   <span class="comment">// Subtract the calculated energy loss of this particle from the measured energy</span></div><div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;   <span class="comment">// loss of all detectors it passed through.</span></div><div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;</div><div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;   TIter nxt(<a class="code" href="classKVReconstructedNucleus.html#a4f38ac3aa016c74920a045e1be77f13d">GetDetectorList</a>(), kIterBackward);</div><div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;   <a class="code" href="classKVDetector.html">KVDetector</a>* det;</div><div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;   Double_t Einc = <a class="code" href="classKVParticle.html#a4ee1e4204aed7301503f32e0b542781e">GetEnergy</a>() - <a class="code" href="classKVReconstructedNucleus.html#a29cc65d62e1cc4fe7dd62da20d80e15a">GetTargetEnergyLoss</a>(); <span class="comment">// energy before first detector</span></div><div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;   <span class="keywordflow">while</span> ((det = (<a class="code" href="classKVDetector.html">KVDetector</a>*)nxt())) {</div><div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;      Double_t Edet = det-&gt;<a class="code" href="classKVDetector.html#ab64fcb32e4162e14ba04320803b0967f">GetEnergy</a>();</div><div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;      Double_t dE = det-&gt;<a class="code" href="classKVDetector.html#acfee1c714ddc99d62a026c4de199fbbe">GetDeltaE</a>(<a class="code" href="classKVNucleus.html#ae9060d423b1a4a895e1305cc31631127">GetZ</a>(), <a class="code" href="classKVNucleus.html#a5d1a5c1b9ea016d11b9b4bd803c3a8c4">GetA</a>(), Einc); <span class="comment">// calculate apparent energy loss in active layer</span></div><div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;      Double_t Eres = det-&gt;<a class="code" href="classKVDetector.html#a270ceeb047bf0d3037d7e71ff5dd0f5c">GetERes</a>(<a class="code" href="classKVNucleus.html#ae9060d423b1a4a895e1305cc31631127">GetZ</a>(), <a class="code" href="classKVNucleus.html#a5d1a5c1b9ea016d11b9b4bd803c3a8c4">GetA</a>(), Einc); <span class="comment">// calculate energy after detector</span></div><div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;      Edet -= dE;</div><div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;      <span class="keywordflow">if</span> (Edet &lt; 0.1) Edet = 0.;</div><div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;      det-&gt;<a class="code" href="classKVDetector.html#a92d1fd5bd481943baf0b192cedb1f924">SetEnergyLoss</a>(Edet);</div><div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;      Einc = Eres;</div><div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;      <span class="keywordflow">if</span> (Einc &lt; 0.1) <span class="keywordflow">break</span>;</div><div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;   }</div><div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;}</div><div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;</div><div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;</div><div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;</div><div class="ttc" id="classKVParticle_html_a37d725bbc656e6765d0a5eced52bc546"><div class="ttname"><a href="classKVParticle.html#a37d725bbc656e6765d0a5eced52bc546">KVParticle::GetTheta</a></div><div class="ttdeci">Double_t GetTheta() const</div><div class="ttdef"><b>Definition:</b> <a href="KVParticle_8h_source.html#l00280">KVParticle.h:280</a></div></div>
<div class="ttc" id="classKVGroup_html_aa2112c5501a8059fe831ff73c17ce621"><div class="ttname"><a href="classKVGroup.html#aa2112c5501a8059fe831ff73c17ce621">KVGroup::AddHit</a></div><div class="ttdeci">void AddHit(KVNucleus *kvd)</div><div class="ttdef"><b>Definition:</b> <a href="KVGroup_8cpp_source.html#l00129">KVGroup.cpp:129</a></div></div>
<div class="ttc" id="classKVReconstructedNucleus_html_a1a6a0ae1878ac5df37cfafaede899340"><div class="ttname"><a href="classKVReconstructedNucleus.html#a1a6a0ae1878ac5df37cfafaede899340">KVReconstructedNucleus::SetAMeasured</a></div><div class="ttdeci">virtual void SetAMeasured(Bool_t yes=kTRUE)</div><div class="ttdef"><b>Definition:</b> <a href="KVReconstructedNucleus_8h_source.html#l00301">KVReconstructedNucleus.h:301</a></div></div>
<div class="ttc" id="classKVPosition_html_abe44ed6ba5d44c3173d0ff22e981fa55"><div class="ttname"><a href="classKVPosition.html#abe44ed6ba5d44c3173d0ff22e981fa55">KVPosition::GetSolidAngle</a></div><div class="ttdeci">virtual Double_t GetSolidAngle(void)</div><div class="ttdef"><b>Definition:</b> <a href="KVPosition_8cpp_source.html#l00619">KVPosition.cpp:619</a></div></div>
<div class="ttc" id="classKVNucleus_html_a5f711989f6f6a1c8d6faa0201fc67bca"><div class="ttname"><a href="classKVNucleus.html#a5f711989f6f6a1c8d6faa0201fc67bca">KVNucleus::SetA</a></div><div class="ttdeci">void SetA(Int_t a)</div><div class="ttdef"><b>Definition:</b> <a href="KVNucleus_8cpp_source.html#l00810">KVNucleus.cpp:810</a></div></div>
<div class="ttc" id="classKVReconstructedNucleus_html_a4e2e49011cb7f1f5fab32137d235aec3"><div class="ttname"><a href="classKVReconstructedNucleus.html#a4e2e49011cb7f1f5fab32137d235aec3">KVReconstructedNucleus::GetRealA</a></div><div class="ttdeci">Float_t GetRealA() const</div><div class="ttdef"><b>Definition:</b> <a href="KVReconstructedNucleus_8h_source.html#l00268">KVReconstructedNucleus.h:268</a></div></div>
<div class="ttc" id="classKVNameValueList_html_a02561d65b153400e421977aa45d78dcb"><div class="ttname"><a href="classKVNameValueList.html#a02561d65b153400e421977aa45d78dcb">KVNameValueList::Print</a></div><div class="ttdeci">virtual void Print(Option_t *opt=&quot;&quot;) const</div><div class="ttdef"><b>Definition:</b> <a href="KVNameValueList_8cpp_source.html#l00209">KVNameValueList.cpp:209</a></div></div>
<div class="ttc" id="classKVReconstructedNucleus_html_a4c884fe876031e0266aa83009c2240b6"><div class="ttname"><a href="classKVReconstructedNucleus.html#a4c884fe876031e0266aa83009c2240b6">KVReconstructedNucleus::GetNumberOfIdentificationResults</a></div><div class="ttdeci">Int_t GetNumberOfIdentificationResults() const</div><div class="ttdef"><b>Definition:</b> <a href="KVReconstructedNucleus_8h_source.html#l00337">KVReconstructedNucleus.h:337</a></div></div>
<div class="ttc" id="classKVReconstructedNucleus_html_ad11cde034966270d6b3c96a969b4ea9c"><div class="ttname"><a href="classKVReconstructedNucleus.html#ad11cde034966270d6b3c96a969b4ea9c">KVReconstructedNucleus::fTargetEnergyLoss</a></div><div class="ttdeci">Double_t fTargetEnergyLoss</div><div class="ttdoc">calculated energy lost in target </div><div class="ttdef"><b>Definition:</b> <a href="KVReconstructedNucleus_8h_source.html#l00036">KVReconstructedNucleus.h:36</a></div></div>
<div class="ttc" id="classKVReconstructedNucleus_html_a8db81d04943705c4a59a8f9d08236e1b"><div class="ttname"><a href="classKVReconstructedNucleus.html#a8db81d04943705c4a59a8f9d08236e1b">KVReconstructedNucleus::SetTargetEnergyLoss</a></div><div class="ttdeci">virtual void SetTargetEnergyLoss(Double_t e)</div><div class="ttdef"><b>Definition:</b> <a href="KVReconstructedNucleus_8h_source.html#l00284">KVReconstructedNucleus.h:284</a></div></div>
<div class="ttc" id="classKVReconstructedNucleus_html_a8fb014a392dbaa9e25856ea9352bc8a5"><div class="ttname"><a href="classKVReconstructedNucleus.html#a8fb014a392dbaa9e25856ea9352bc8a5">KVReconstructedNucleus::SetIsCalibrated</a></div><div class="ttdeci">void SetIsCalibrated()</div><div class="ttdef"><b>Definition:</b> <a href="KVReconstructedNucleus_8h_source.html#l00223">KVReconstructedNucleus.h:223</a></div></div>
<div class="ttc" id="classKVReconstructedNucleus_html_a5aff056034d1c6cbcc1c339506a45163"><div class="ttname"><a href="classKVReconstructedNucleus.html#a5aff056034d1c6cbcc1c339506a45163">KVReconstructedNucleus::SetIdentification</a></div><div class="ttdeci">virtual void SetIdentification(KVIdentificationResult *)</div><div class="ttdef"><b>Definition:</b> <a href="KVReconstructedNucleus_8cpp_source.html#l00810">KVReconstructedNucleus.cpp:810</a></div></div>
<div class="ttc" id="classKVReconstructedNucleus_html_a658008aa049a13c4b901ec58329d836a"><div class="ttname"><a href="classKVReconstructedNucleus.html#a658008aa049a13c4b901ec58329d836a">KVReconstructedNucleus::KVReconstructedNucleus</a></div><div class="ttdeci">KVReconstructedNucleus()</div><div class="ttdoc">default ctor. </div><div class="ttdef"><b>Definition:</b> <a href="KVReconstructedNucleus_8cpp_source.html#l00107">KVReconstructedNucleus.cpp:107</a></div></div>
<div class="ttc" id="classKVDetector_html_adcc95d176097e864da9e39d225c5ba4f"><div class="ttname"><a href="classKVDetector.html#adcc95d176097e864da9e39d225c5ba4f">KVDetector::AddHit</a></div><div class="ttdeci">void AddHit(KVNucleus *part)</div><div class="ttdef"><b>Definition:</b> <a href="KVDetector_8h_source.html#l00251">KVDetector.h:251</a></div></div>
<div class="ttc" id="classKVReconstructedNucleus_html_a4dc82d00456c3e5a5267bbccada20844"><div class="ttname"><a href="classKVReconstructedNucleus.html#a4dc82d00456c3e5a5267bbccada20844">KVReconstructedNucleus::SetStatus</a></div><div class="ttdeci">void SetStatus(Int_t a)</div><div class="ttdef"><b>Definition:</b> <a href="KVReconstructedNucleus_8h_source.html#l00149">KVReconstructedNucleus.h:149</a></div></div>
<div class="ttc" id="classKVIdentificationResult_html_a27a4322a2ac797a813148cb63af3339c"><div class="ttname"><a href="classKVIdentificationResult.html#a27a4322a2ac797a813148cb63af3339c">KVIdentificationResult::IDOK</a></div><div class="ttdeci">Bool_t IDOK</div><div class="ttdoc">general quality of identification, =kTRUE if acceptable identification made </div><div class="ttdef"><b>Definition:</b> <a href="KVIdentificationResult_8h_source.html#l00010">KVIdentificationResult.h:10</a></div></div>
<div class="ttc" id="classKVMultiDetArray_html_a23bc007d119c7e180bd6a5286a05cfbf"><div class="ttname"><a href="classKVMultiDetArray.html#a23bc007d119c7e180bd6a5286a05cfbf">KVMultiDetArray::GetTargetEnergyLossCorrection</a></div><div class="ttdeci">virtual Double_t GetTargetEnergyLossCorrection(KVReconstructedNucleus *)</div><div class="ttdef"><b>Definition:</b> <a href="KVMultiDetArray_8cpp_source.html#l02757">KVMultiDetArray.cpp:2757</a></div></div>
<div class="ttc" id="classKVReconstructedNucleus_html_a529110755c7248eb8b30681d4454bed7"><div class="ttname"><a href="classKVReconstructedNucleus.html#a529110755c7248eb8b30681d4454bed7">KVReconstructedNucleus::Copy</a></div><div class="ttdeci">virtual void Copy(TObject &amp;) const</div><div class="ttdef"><b>Definition:</b> <a href="KVReconstructedNucleus_8cpp_source.html#l00312">KVReconstructedNucleus.cpp:312</a></div></div>
<div class="ttc" id="classKVDetector_html_aba8fb091c9f1f6dcef8fbca1236d2b63"><div class="ttname"><a href="classKVDetector.html#aba8fb091c9f1f6dcef8fbca1236d2b63">KVDetector::IsDetecting</a></div><div class="ttdeci">virtual Bool_t IsDetecting() const</div><div class="ttdef"><b>Definition:</b> <a href="KVDetector_8h_source.html#l00416">KVDetector.h:416</a></div></div>
<div class="ttc" id="classKVIdentificationResult_html_a8b78ca5befdc2d9c7a71f6dd6c659f7e"><div class="ttname"><a href="classKVIdentificationResult.html#a8b78ca5befdc2d9c7a71f6dd6c659f7e">KVIdentificationResult::PID</a></div><div class="ttdeci">Double_t PID</div><div class="ttdoc">= &quot;real&quot; Z if Zident==kTRUE and Aident==kFALSE, &quot;real&quot; A if Zident==Aident==kTRUE ...</div><div class="ttdef"><b>Definition:</b> <a href="KVIdentificationResult_8h_source.html#l00017">KVIdentificationResult.h:17</a></div></div>
<div class="ttc" id="classKVReconstructedNucleus_html_a52ea2416aca1cde6a5e881ae4df12717"><div class="ttname"><a href="classKVReconstructedNucleus.html#a52ea2416aca1cde6a5e881ae4df12717">KVReconstructedNucleus::IsCalibrated</a></div><div class="ttdeci">Bool_t IsCalibrated() const</div><div class="ttdef"><b>Definition:</b> <a href="KVReconstructedNucleus_8h_source.html#l00243">KVReconstructedNucleus.h:243</a></div></div>
<div class="ttc" id="classKVIdentificationResult_html_a05f516b0194ba311b101f8b796a94173"><div class="ttname"><a href="classKVIdentificationResult.html#a05f516b0194ba311b101f8b796a94173">KVIdentificationResult::IDattempted</a></div><div class="ttdeci">Bool_t IDattempted</div><div class="ttdoc">=kTRUE if identification was attempted </div><div class="ttdef"><b>Definition:</b> <a href="KVIdentificationResult_8h_source.html#l00009">KVIdentificationResult.h:9</a></div></div>
<div class="ttc" id="KVIDTelescope_8h_html"><div class="ttname"><a href="KVIDTelescope_8h.html">KVIDTelescope.h</a></div></div>
<div class="ttc" id="classKVPosition_html_a1f2422675a97b3691c8ed99a654bfd4f"><div class="ttname"><a href="classKVPosition.html#a1f2422675a97b3691c8ed99a654bfd4f">KVPosition::GetRandomDirection</a></div><div class="ttdeci">TVector3 GetRandomDirection(Option_t *t=&quot;isotropic&quot;)</div><div class="ttdef"><b>Definition:</b> <a href="KVPosition_8cpp_source.html#l00295">KVPosition.cpp:295</a></div></div>
<div class="ttc" id="classKVReconstructedNucleus_html_ab82a33c7e33b768613f289a0f0e554ac"><div class="ttname"><a href="classKVReconstructedNucleus.html#ab82a33c7e33b768613f289a0f0e554ac">KVReconstructedNucleus::GetDetector</a></div><div class="ttdeci">KVDetector * GetDetector(int i) const</div><div class="ttdef"><b>Definition:</b> <a href="KVReconstructedNucleus_8h_source.html#l00077">KVReconstructedNucleus.h:77</a></div></div>
<div class="ttc" id="classKVParticle_html_a32a39659542dbdd65c691f70524e4ea4"><div class="ttname"><a href="classKVParticle.html#a32a39659542dbdd65c691f70524e4ea4">KVParticle::GetParameters</a></div><div class="ttdeci">KVNameValueList * GetParameters() const</div><div class="ttdef"><b>Definition:</b> <a href="KVParticle_8h_source.html#l00373">KVParticle.h:373</a></div></div>
<div class="ttc" id="classKVReconstructedNucleus_html_a903dafc7f507288bd0407803718475f5"><div class="ttname"><a href="classKVReconstructedNucleus.html#a903dafc7f507288bd0407803718475f5">KVReconstructedNucleus::fDetNames</a></div><div class="ttdeci">KVString fDetNames</div><div class="ttdoc">list of names of detectors through which particle passed </div><div class="ttdef"><b>Definition:</b> <a href="KVReconstructedNucleus_8h_source.html#l00019">KVReconstructedNucleus.h:19</a></div></div>
<div class="ttc" id="classKVDetector_html_ab9445c8f26f4e4ad0fce600f5fb6eb28"><div class="ttname"><a href="classKVDetector.html#ab9445c8f26f4e4ad0fce600f5fb6eb28">KVDetector::GetSegment</a></div><div class="ttdeci">UShort_t GetSegment() const</div><div class="ttdef"><b>Definition:</b> <a href="KVDetector_8h_source.html#l00493">KVDetector.h:493</a></div></div>
<div class="ttc" id="classKVIdentificationResult_html_a40c40ad2e24a507458e1727701669310"><div class="ttname"><a href="classKVIdentificationResult.html#a40c40ad2e24a507458e1727701669310">KVIdentificationResult::Copy</a></div><div class="ttdeci">void Copy(TObject &amp;) const</div><div class="ttdoc">Copy this to obj. </div><div class="ttdef"><b>Definition:</b> <a href="KVIdentificationResult_8cpp_source.html#l00075">KVIdentificationResult.cpp:75</a></div></div>
<div class="ttc" id="classKVSeqCollection_html_a5edbe1ce090e93f70da107c1dc5abbe1"><div class="ttname"><a href="classKVSeqCollection.html#a5edbe1ce090e93f70da107c1dc5abbe1">KVSeqCollection::Clear</a></div><div class="ttdeci">virtual void Clear(Option_t *option=&quot;&quot;)</div><div class="ttdef"><b>Definition:</b> <a href="KVSeqCollection_8cpp_source.html#l00411">KVSeqCollection.cpp:411</a></div></div>
<div class="ttc" id="classKVSeqCollection_html_ad8572701209c97af7ed6e2fd72978a6b"><div class="ttname"><a href="classKVSeqCollection.html#ad8572701209c97af7ed6e2fd72978a6b">KVSeqCollection::Add</a></div><div class="ttdeci">virtual void Add(TObject *obj)</div><div class="ttdef"><b>Definition:</b> <a href="KVSeqCollection_8h_source.html#l00142">KVSeqCollection.h:142</a></div></div>
<div class="ttc" id="classKVParticle_html_a9f310fb346e582c66d7f640c0e6ae87e"><div class="ttname"><a href="classKVParticle.html#a9f310fb346e582c66d7f640c0e6ae87e">KVParticle::SetParameter</a></div><div class="ttdeci">void SetParameter(const Char_t *name, ValType value) const</div><div class="ttdef"><b>Definition:</b> <a href="KVParticle_8h_source.html#l00377">KVParticle.h:377</a></div></div>
<div class="ttc" id="classKVReconstructedNucleus_html_a20fdf05449df9edca542e5a8f18f1e50"><div class="ttname"><a href="classKVReconstructedNucleus.html#a20fdf05449df9edca542e5a8f18f1e50">KVReconstructedNucleus::GetAnglesFromStoppingDetector</a></div><div class="ttdeci">virtual void GetAnglesFromStoppingDetector(Option_t *opt=&quot;random&quot;)</div><div class="ttdef"><b>Definition:</b> <a href="KVReconstructedNucleus_8cpp_source.html#l00695">KVReconstructedNucleus.cpp:695</a></div></div>
<div class="ttc" id="namespacestd_html"><div class="ttname"><a href="namespacestd.html">std</a></div><div class="ttdoc">STL namespace. </div></div>
<div class="ttc" id="classKVReconstructedNucleus_html_a225bc41a3152a3f98c19676bc9f09bcfa2a9e7ad5e6c7f973f1e127df5384995e"><div class="ttname"><a href="classKVReconstructedNucleus.html#a225bc41a3152a3f98c19676bc9f09bcfa2a9e7ad5e6c7f973f1e127df5384995e">KVReconstructedNucleus::kStatusOK</a></div><div class="ttdef"><b>Definition:</b> <a href="KVReconstructedNucleus_8h_source.html#l00046">KVReconstructedNucleus.h:46</a></div></div>
<div class="ttc" id="classKVReconstructedNucleus_html_a52f50790b587156e0decd14f7aff78be"><div class="ttname"><a href="classKVReconstructedNucleus.html#a52f50790b587156e0decd14f7aff78be">KVReconstructedNucleus::GetIdentificationResult</a></div><div class="ttdeci">KVIdentificationResult * GetIdentificationResult(Int_t i)</div><div class="ttdef"><b>Definition:</b> <a href="KVReconstructedNucleus_8h_source.html#l00319">KVReconstructedNucleus.h:319</a></div></div>
<div class="ttc" id="classKVIdentificationResult_html_a38ba4ea0908dd61e48428a0decfa327c"><div class="ttname"><a href="classKVIdentificationResult.html#a38ba4ea0908dd61e48428a0decfa327c">KVIdentificationResult::Print</a></div><div class="ttdeci">void Print(Option_t *opt=&quot;&quot;) const</div><div class="ttdef"><b>Definition:</b> <a href="KVIdentificationResult_8cpp_source.html#l00118">KVIdentificationResult.cpp:118</a></div></div>
<div class="ttc" id="classKVReconstructedNucleus_html_a1f33be9dc3a0edd79e7a6a0d1f28dfb2"><div class="ttname"><a href="classKVReconstructedNucleus.html#a1f33be9dc3a0edd79e7a6a0d1f28dfb2">KVReconstructedNucleus::GetNumDet</a></div><div class="ttdeci">Int_t GetNumDet() const</div><div class="ttdef"><b>Definition:</b> <a href="KVReconstructedNucleus_8h_source.html#l00103">KVReconstructedNucleus.h:103</a></div></div>
<div class="ttc" id="classKVReconstructedNucleus_html_af7a910f9061bf8a4da8934c60a8910b9"><div class="ttname"><a href="classKVReconstructedNucleus.html#af7a910f9061bf8a4da8934c60a8910b9">KVReconstructedNucleus::fAnalStatus</a></div><div class="ttdeci">Int_t fAnalStatus</div><div class="ttdoc">status of particle after analysis of reconstructed event </div><div class="ttdef"><b>Definition:</b> <a href="KVReconstructedNucleus_8h_source.html#l00033">KVReconstructedNucleus.h:33</a></div></div>
<div class="ttc" id="classKVList_html"><div class="ttname"><a href="classKVList.html">KVList</a></div><div class="ttdoc">Extended TList class which owns its objects by default. </div><div class="ttdef"><b>Definition:</b> <a href="KVList_8h_source.html#l00007">KVList.h:7</a></div></div>
<div class="ttc" id="classKVReconstructedNucleus_html_acee860c82ffaf63965a4ab379a9f9575"><div class="ttname"><a href="classKVReconstructedNucleus.html#acee860c82ffaf63965a4ab379a9f9575">KVReconstructedNucleus::AddDetector</a></div><div class="ttdeci">void AddDetector(KVDetector *)</div><div class="ttdef"><b>Definition:</b> <a href="KVReconstructedNucleus_8cpp_source.html#l00358">KVReconstructedNucleus.cpp:358</a></div></div>
<div class="ttc" id="classKVIdentificationResult_html_ac2c5bd2256c03125bbf2ea386d9975f9"><div class="ttname"><a href="classKVIdentificationResult.html#ac2c5bd2256c03125bbf2ea386d9975f9">KVIdentificationResult::IDcode</a></div><div class="ttdeci">Int_t IDcode</div><div class="ttdoc">a general identification code for this type of identification </div><div class="ttdef"><b>Definition:</b> <a href="KVIdentificationResult_8h_source.html#l00011">KVIdentificationResult.h:11</a></div></div>
<div class="ttc" id="classKVReconstructedNucleus_html_a7dc06514cd3bba95e10241d743d9c74d"><div class="ttname"><a href="classKVReconstructedNucleus.html#a7dc06514cd3bba95e10241d743d9c74d">KVReconstructedNucleus::IsIdentified</a></div><div class="ttdeci">Bool_t IsIdentified() const</div><div class="ttdef"><b>Definition:</b> <a href="KVReconstructedNucleus_8h_source.html#l00239">KVReconstructedNucleus.h:239</a></div></div>
<div class="ttc" id="classKVReconstructedNucleus_html_ad6521fe731a8dd967bf4fa55bcd76177"><div class="ttname"><a href="classKVReconstructedNucleus.html#ad6521fe731a8dd967bf4fa55bcd76177">KVReconstructedNucleus::Clear</a></div><div class="ttdeci">virtual void Clear(Option_t *option=&quot;&quot;)</div><div class="ttdef"><b>Definition:</b> <a href="KVReconstructedNucleus_8cpp_source.html#l00336">KVReconstructedNucleus.cpp:336</a></div></div>
<div class="ttc" id="classKVDetector_html_a0bd4ac1b0d97b99a53f3b608625ffef5"><div class="ttname"><a href="classKVDetector.html#a0bd4ac1b0d97b99a53f3b608625ffef5">KVDetector::IncrementIdentifiedParticles</a></div><div class="ttdeci">void IncrementIdentifiedParticles(Int_t n=1)</div><div class="ttdef"><b>Definition:</b> <a href="KVDetector_8h_source.html#l00310">KVDetector.h:310</a></div></div>
<div class="ttc" id="classKVReconstructedNucleus_html_a225bc41a3152a3f98c19676bc9f09bcfa23e77bb7c1a77d57466580ca201103cf"><div class="ttname"><a href="classKVReconstructedNucleus.html#a225bc41a3152a3f98c19676bc9f09bcfa23e77bb7c1a77d57466580ca201103cf">KVReconstructedNucleus::kStatusOKafterShare</a></div><div class="ttdef"><b>Definition:</b> <a href="KVReconstructedNucleus_8h_source.html#l00049">KVReconstructedNucleus.h:49</a></div></div>
<div class="ttc" id="classKVReconstructedNucleus_html_a8bf22b6b8c63d4febee44dab9d5198e0"><div class="ttname"><a href="classKVReconstructedNucleus.html#a8bf22b6b8c63d4febee44dab9d5198e0">KVReconstructedNucleus::fIDResults</a></div><div class="ttdeci">TClonesArray fIDResults</div><div class="ttdoc">results of every identification attempt made for this nucleus, in order of the ID telescopes used ...</div><div class="ttdef"><b>Definition:</b> <a href="KVReconstructedNucleus_8h_source.html#l00038">KVReconstructedNucleus.h:38</a></div></div>
<div class="ttc" id="classKVReconstructedNucleus_html_a3e88c8d36d75796d307c8547c7e39fc9"><div class="ttname"><a href="classKVReconstructedNucleus.html#a3e88c8d36d75796d307c8547c7e39fc9">KVReconstructedNucleus::GetNUnidentifiedInGroup</a></div><div class="ttdeci">static UInt_t GetNUnidentifiedInGroup(KVGroup *grp)</div><div class="ttdef"><b>Definition:</b> <a href="KVReconstructedNucleus_8h_source.html#l00413">KVReconstructedNucleus.h:413</a></div></div>
<div class="ttc" id="classKVDetector_html_ab64fcb32e4162e14ba04320803b0967f"><div class="ttname"><a href="classKVDetector.html#ab64fcb32e4162e14ba04320803b0967f">KVDetector::GetEnergy</a></div><div class="ttdeci">virtual Double_t GetEnergy()</div><div class="ttdef"><b>Definition:</b> <a href="KVDetector_8h_source.html#l00197">KVDetector.h:197</a></div></div>
<div class="ttc" id="classKVNucleus_html_a5d1a5c1b9ea016d11b9b4bd803c3a8c4"><div class="ttname"><a href="classKVNucleus.html#a5d1a5c1b9ea016d11b9b4bd803c3a8c4">KVNucleus::GetA</a></div><div class="ttdeci">Int_t GetA() const</div><div class="ttdef"><b>Definition:</b> <a href="KVNucleus_8cpp_source.html#l00953">KVNucleus.cpp:953</a></div></div>
<div class="ttc" id="classKVGroup_html_add6bc2fea7023957d38c2e621f85ca74"><div class="ttname"><a href="classKVGroup.html#add6bc2fea7023957d38c2e621f85ca74">KVGroup::Reset</a></div><div class="ttdeci">void Reset()</div><div class="ttdef"><b>Definition:</b> <a href="KVGroup_8cpp_source.html#l00111">KVGroup.cpp:111</a></div></div>
<div class="ttc" id="KVGroup_8h_html"><div class="ttname"><a href="KVGroup_8h.html">KVGroup.h</a></div></div>
<div class="ttc" id="classKVDetector_html_a338f814acba30617cecc483780da5e8c"><div class="ttname"><a href="classKVDetector.html#a338f814acba30617cecc483780da5e8c">KVDetector::GetAlignedIDTelescopes</a></div><div class="ttdeci">KVList * GetAlignedIDTelescopes()</div><div class="ttdef"><b>Definition:</b> <a href="KVDetector_8cpp_source.html#l00896">KVDetector.cpp:896</a></div></div>
<div class="ttc" id="classKVParticle_html_a4ee1e4204aed7301503f32e0b542781e"><div class="ttname"><a href="classKVParticle.html#a4ee1e4204aed7301503f32e0b542781e">KVParticle::GetEnergy</a></div><div class="ttdeci">Double_t GetEnergy() const</div><div class="ttdef"><b>Definition:</b> <a href="KVParticle_8h_source.html#l00215">KVParticle.h:215</a></div></div>
<div class="ttc" id="classKVDetector_html_a36c14085e0ec80f25c1bf8fd47e1232f"><div class="ttname"><a href="classKVDetector.html#a36c14085e0ec80f25c1bf8fd47e1232f">KVDetector::GetGroup</a></div><div class="ttdeci">KVGroup * GetGroup() const</div><div class="ttdef"><b>Definition:</b> <a href="KVDetector_8cpp_source.html#l02188">KVDetector.cpp:2188</a></div></div>
<div class="ttc" id="classKVReconstructedNucleus_html_a7a8adbc880fb38065a4234912a19a177"><div class="ttname"><a href="classKVReconstructedNucleus.html#a7a8adbc880fb38065a4234912a19a177">KVReconstructedNucleus::SetRealA</a></div><div class="ttdeci">void SetRealA(Float_t A)</div><div class="ttdef"><b>Definition:</b> <a href="KVReconstructedNucleus_8h_source.html#l00252">KVReconstructedNucleus.h:252</a></div></div>
<div class="ttc" id="classKVReconstructedNucleus_html_a4f38ac3aa016c74920a045e1be77f13d"><div class="ttname"><a href="classKVReconstructedNucleus.html#a4f38ac3aa016c74920a045e1be77f13d">KVReconstructedNucleus::GetDetectorList</a></div><div class="ttdeci">const KVSeqCollection * GetDetectorList() const</div><div class="ttdef"><b>Definition:</b> <a href="KVReconstructedNucleus_8h_source.html#l00067">KVReconstructedNucleus.h:67</a></div></div>
<div class="ttc" id="classKVReconstructedNucleus_html_a8c9249feead1176572f38dd5da4ca3cb"><div class="ttname"><a href="classKVReconstructedNucleus.html#a8c9249feead1176572f38dd5da4ca3cb">KVReconstructedNucleus::GetStoppingDetector</a></div><div class="ttdeci">KVDetector * GetStoppingDetector() const</div><div class="ttdef"><b>Definition:</b> <a href="KVReconstructedNucleus_8h_source.html#l00098">KVReconstructedNucleus.h:98</a></div></div>
<div class="ttc" id="classKVReconstructedNucleus_html_a43dec454bb300756ea7ab4dce812f9c0"><div class="ttname"><a href="classKVReconstructedNucleus.html#a43dec454bb300756ea7ab4dce812f9c0">KVReconstructedNucleus::SetNSegDet</a></div><div class="ttdeci">void SetNSegDet(Int_t seg)</div><div class="ttdef"><b>Definition:</b> <a href="KVReconstructedNucleus_8h_source.html#l00113">KVReconstructedNucleus.h:113</a></div></div>
<div class="ttc" id="classKVDetector_html_a2453589a9a3884097d22c60321cb0483"><div class="ttname"><a href="classKVDetector.html#a2453589a9a3884097d22c60321cb0483">KVDetector::IncrementUnidentifiedParticles</a></div><div class="ttdeci">void IncrementUnidentifiedParticles(Int_t n=1)</div><div class="ttdef"><b>Definition:</b> <a href="KVDetector_8h_source.html#l00304">KVDetector.h:304</a></div></div>
<div class="ttc" id="classKVReconstructedNucleus_html_ac461adab70c95ee1badae3064318fef2"><div class="ttname"><a href="classKVReconstructedNucleus.html#ac461adab70c95ee1badae3064318fef2">KVReconstructedNucleus::fNSegDet</a></div><div class="ttdeci">Int_t fNSegDet</div><div class="ttdoc">number of segmented/independent detectors hit by particle </div><div class="ttdef"><b>Definition:</b> <a href="KVReconstructedNucleus_8h_source.html#l00032">KVReconstructedNucleus.h:32</a></div></div>
<div class="ttc" id="classKVReconstructedNucleus_html_a225bc41a3152a3f98c19676bc9f09bcfa7391cd71d9354f5de36b7d012975fdb2"><div class="ttname"><a href="classKVReconstructedNucleus.html#a225bc41a3152a3f98c19676bc9f09bcfa7391cd71d9354f5de36b7d012975fdb2">KVReconstructedNucleus::kStatusPileupGhost</a></div><div class="ttdef"><b>Definition:</b> <a href="KVReconstructedNucleus_8h_source.html#l00054">KVReconstructedNucleus.h:54</a></div></div>
<div class="ttc" id="classKVSeqCollection_html_a79e71dc3aba24a091398199d670b5837"><div class="ttname"><a href="classKVSeqCollection.html#a79e71dc3aba24a091398199d670b5837">KVSeqCollection::First</a></div><div class="ttdeci">virtual TObject * First() const</div><div class="ttdef"><b>Definition:</b> <a href="KVSeqCollection_8h_source.html#l00134">KVSeqCollection.h:134</a></div></div>
<div class="ttc" id="classKVIdentificationResult_html"><div class="ttname"><a href="classKVIdentificationResult.html">KVIdentificationResult</a></div><div class="ttdoc">Full result of one attempted particle identification. </div><div class="ttdef"><b>Definition:</b> <a href="KVIdentificationResult_8h_source.html#l00007">KVIdentificationResult.h:7</a></div></div>
<div class="ttc" id="classKVNucleus_html"><div class="ttname"><a href="classKVNucleus.html">KVNucleus</a></div><div class="ttdef"><b>Definition:</b> <a href="KVNucleus_8h_source.html#l00027">KVNucleus.h:27</a></div></div>
<div class="ttc" id="classKVReconstructedNucleus_html_af1da5d70c9e9e15b2b66d90ecaa23fa9"><div class="ttname"><a href="classKVReconstructedNucleus.html#af1da5d70c9e9e15b2b66d90ecaa23fa9">KVReconstructedNucleus::fIDTelescope</a></div><div class="ttdeci">KVIDTelescope * fIDTelescope</div><div class="ttdoc">non-persistent pointer to identification telescope </div><div class="ttdef"><b>Definition:</b> <a href="KVReconstructedNucleus_8h_source.html#l00022">KVReconstructedNucleus.h:22</a></div></div>
<div class="ttc" id="classKVIdentificationResult_html_ab9c910682f27824de0d9ecc64fe0af9b"><div class="ttname"><a href="classKVIdentificationResult.html#ab9c910682f27824de0d9ecc64fe0af9b">KVIdentificationResult::Z</a></div><div class="ttdeci">Int_t Z</div><div class="ttdoc">Z of particle found (if Zident==kTRUE) </div><div class="ttdef"><b>Definition:</b> <a href="KVIdentificationResult_8h_source.html#l00015">KVIdentificationResult.h:15</a></div></div>
<div class="ttc" id="classKVNucleus_html_aa42f8a49ffe37c71784fc60cfdf1d2e9"><div class="ttname"><a href="classKVNucleus.html#aa42f8a49ffe37c71784fc60cfdf1d2e9">KVNucleus::Copy</a></div><div class="ttdeci">virtual void Copy(TObject &amp;) const</div><div class="ttdoc">Copy this KVNucleus into the KVNucleus object referenced by &quot;obj&quot;. </div><div class="ttdef"><b>Definition:</b> <a href="KVNucleus_8cpp_source.html#l00975">KVNucleus.cpp:975</a></div></div>
<div class="ttc" id="classKVReconstructedNucleus_html_aa91c50893bc2883353470b5ccb996b34"><div class="ttname"><a href="classKVReconstructedNucleus.html#aa91c50893bc2883353470b5ccb996b34">KVReconstructedNucleus::GetNSegDet</a></div><div class="ttdeci">Int_t GetNSegDet() const</div><div class="ttdef"><b>Definition:</b> <a href="KVReconstructedNucleus_8h_source.html#l00107">KVReconstructedNucleus.h:107</a></div></div>
<div class="ttc" id="classKVReconstructedNucleus_html_a0803855f21715d103c54bd6d4a865944"><div class="ttname"><a href="classKVReconstructedNucleus.html#a0803855f21715d103c54bd6d4a865944">KVReconstructedNucleus::SetIDCode</a></div><div class="ttdeci">virtual void SetIDCode(UShort_t s)</div><div class="ttdef"><b>Definition:</b> <a href="KVReconstructedNucleus_8h_source.html#l00192">KVReconstructedNucleus.h:192</a></div></div>
<div class="ttc" id="classKVNucleus_html_a6983e634af13af641a0d7f4725ca6521"><div class="ttname"><a href="classKVNucleus.html#a6983e634af13af641a0d7f4725ca6521">KVNucleus::SetZ</a></div><div class="ttdeci">void SetZ(Int_t z, Char_t mt=-1)</div><div class="ttdef"><b>Definition:</b> <a href="KVNucleus_8cpp_source.html#l00858">KVNucleus.cpp:858</a></div></div>
<div class="ttc" id="classKVReconstructedNucleus_html_a598739f023dc0e3ca7777aa8f5a8e873"><div class="ttname"><a href="classKVReconstructedNucleus.html#a598739f023dc0e3ca7777aa8f5a8e873">KVReconstructedNucleus::fDetList</a></div><div class="ttdeci">KVHashList fDetList</div><div class="ttdoc">non-persistent list of pointers to detectors </div><div class="ttdef"><b>Definition:</b> <a href="KVReconstructedNucleus_8h_source.html#l00020">KVReconstructedNucleus.h:20</a></div></div>
<div class="ttc" id="classKVGeoDetectorNode_html_ac2dab061ac6d6d3b5d0c744afb6e7740"><div class="ttname"><a href="classKVGeoDetectorNode.html#ac2dab061ac6d6d3b5d0c744afb6e7740">KVGeoDetectorNode::GetDetectorsInFront</a></div><div class="ttdeci">KVSeqCollection * GetDetectorsInFront() const</div><div class="ttdef"><b>Definition:</b> <a href="KVGeoDetectorNode_8h_source.html#l00042">KVGeoDetectorNode.h:42</a></div></div>
<div class="ttc" id="classKVIDTelescope_html_a288fc0f4f235ebb9dec51eb94dc92daf"><div class="ttname"><a href="classKVIDTelescope.html#a288fc0f4f235ebb9dec51eb94dc92daf">KVIDTelescope::Identify</a></div><div class="ttdeci">virtual Bool_t Identify(KVIdentificationResult *, Double_t x=-1., Double_t y=-1.)</div><div class="ttdef"><b>Definition:</b> <a href="KVIDTelescope_8cpp_source.html#l00507">KVIDTelescope.cpp:507</a></div></div>
<div class="ttc" id="classKVIdentificationResult_html_a8886575be80f2a09430412771e868e16"><div class="ttname"><a href="classKVIdentificationResult.html#a8886575be80f2a09430412771e868e16">KVIdentificationResult::Aident</a></div><div class="ttdeci">Bool_t Aident</div><div class="ttdoc">= kTRUE if A of particle established </div><div class="ttdef"><b>Definition:</b> <a href="KVIdentificationResult_8h_source.html#l00013">KVIdentificationResult.h:13</a></div></div>
<div class="ttc" id="classKVIdentificationResult_html_aec29f9b5d2345cb3bf44f2bdd213bbc1"><div class="ttname"><a href="classKVIdentificationResult.html#aec29f9b5d2345cb3bf44f2bdd213bbc1">KVIdentificationResult::Zident</a></div><div class="ttdeci">Bool_t Zident</div><div class="ttdoc">=kTRUE if Z of particle established </div><div class="ttdef"><b>Definition:</b> <a href="KVIdentificationResult_8h_source.html#l00012">KVIdentificationResult.h:12</a></div></div>
<div class="ttc" id="classKVReconstructedNucleus_html_a51ea7eeb7f992dd3cc261f2ca24bd8b7"><div class="ttname"><a href="classKVReconstructedNucleus.html#a51ea7eeb7f992dd3cc261f2ca24bd8b7">KVReconstructedNucleus::Print</a></div><div class="ttdeci">virtual void Print(Option_t *option=&quot;&quot;) const</div><div class="ttdoc">Display nucleus parameters. </div><div class="ttdef"><b>Definition:</b> <a href="KVReconstructedNucleus_8cpp_source.html#l00213">KVReconstructedNucleus.cpp:213</a></div></div>
<div class="ttc" id="classKVReconstructedNucleus_html_ac4b7986f3b92de584fc4bf48493326e3"><div class="ttname"><a href="classKVReconstructedNucleus.html#ac4b7986f3b92de584fc4bf48493326e3">KVReconstructedNucleus::Identify</a></div><div class="ttdeci">virtual void Identify()</div><div class="ttdef"><b>Definition:</b> <a href="KVReconstructedNucleus_8cpp_source.html#l00440">KVReconstructedNucleus.cpp:440</a></div></div>
<div class="ttc" id="classKVReconstructedNucleus_html_a0a342534af0ba910c82df739924da30c"><div class="ttname"><a href="classKVReconstructedNucleus.html#a0a342534af0ba910c82df739924da30c">KVReconstructedNucleus::Reconstruct</a></div><div class="ttdeci">virtual void Reconstruct(KVDetector *kvd)</div><div class="ttdef"><b>Definition:</b> <a href="KVReconstructedNucleus_8cpp_source.html#l00395">KVReconstructedNucleus.cpp:395</a></div></div>
<div class="ttc" id="KVReconstructedNucleus_8h_html"><div class="ttname"><a href="KVReconstructedNucleus_8h.html">KVReconstructedNucleus.h</a></div></div>
<div class="ttc" id="classKVIDTelescope_html"><div class="ttname"><a href="classKVIDTelescope.html">KVIDTelescope</a></div><div class="ttdef"><b>Definition:</b> <a href="KVIDTelescope_8h_source.html#l00036">KVIDTelescope.h:36</a></div></div>
<div class="ttc" id="classKVReconstructedNucleus_html"><div class="ttname"><a href="classKVReconstructedNucleus.html">KVReconstructedNucleus</a></div><div class="ttdef"><b>Definition:</b> <a href="KVReconstructedNucleus_8h_source.html#l00015">KVReconstructedNucleus.h:15</a></div></div>
<div class="ttc" id="classKVIDTelescope_html_a9e5c4a9387bfdd72cce3f4b659e36abf"><div class="ttname"><a href="classKVIDTelescope.html#a9e5c4a9387bfdd72cce3f4b659e36abf">KVIDTelescope::GetCalibStatus</a></div><div class="ttdeci">virtual Int_t GetCalibStatus() const</div><div class="ttdef"><b>Definition:</b> <a href="KVIDTelescope_8h_source.html#l00117">KVIDTelescope.h:117</a></div></div>
<div class="ttc" id="classKVGroup_html_a492627ae39f99e8628768916087cc65a"><div class="ttname"><a href="classKVGroup.html#a492627ae39f99e8628768916087cc65a">KVGroup::GetParticles</a></div><div class="ttdeci">KVList * GetParticles()</div><div class="ttdef"><b>Definition:</b> <a href="KVGroup_8h_source.html#l00054">KVGroup.h:54</a></div></div>
<div class="ttc" id="classKVDetector_html_aebf616ebf7589ceff2c36b9e014b4757"><div class="ttname"><a href="classKVDetector.html#aebf616ebf7589ceff2c36b9e014b4757">KVDetector::SetAnalysed</a></div><div class="ttdeci">void SetAnalysed(Bool_t b=kTRUE)</div><div class="ttdef"><b>Definition:</b> <a href="KVDetector_8h_source.html#l00284">KVDetector.h:284</a></div></div>
<div class="ttc" id="classKVReconstructedNucleus_html_a225bc41a3152a3f98c19676bc9f09bcfa493159641f838af8b403755f98144f7c"><div class="ttname"><a href="classKVReconstructedNucleus.html#a225bc41a3152a3f98c19676bc9f09bcfa493159641f838af8b403755f98144f7c">KVReconstructedNucleus::kStatusStopFirstStage</a></div><div class="ttdef"><b>Definition:</b> <a href="KVReconstructedNucleus_8h_source.html#l00051">KVReconstructedNucleus.h:51</a></div></div>
<div class="ttc" id="classKVPosition_html_af2398473f9dd269dc2254d6877c20716"><div class="ttname"><a href="classKVPosition.html#af2398473f9dd269dc2254d6877c20716">KVPosition::GetDirection</a></div><div class="ttdeci">TVector3 GetDirection()</div><div class="ttdef"><b>Definition:</b> <a href="KVPosition_8cpp_source.html#l00515">KVPosition.cpp:515</a></div></div>
<div class="ttc" id="classKVReconstructedNucleus_html_ade54f876b9edf3e9ac5623403a3b266c"><div class="ttname"><a href="classKVReconstructedNucleus.html#ade54f876b9edf3e9ac5623403a3b266c">KVReconstructedNucleus::GetIdentifyingTelescope</a></div><div class="ttdeci">KVIDTelescope * GetIdentifyingTelescope() const</div><div class="ttdef"><b>Definition:</b> <a href="KVReconstructedNucleus_8h_source.html#l00181">KVReconstructedNucleus.h:181</a></div></div>
<div class="ttc" id="classKVGroup_html"><div class="ttname"><a href="classKVGroup.html">KVGroup</a></div><div class="ttdef"><b>Definition:</b> <a href="KVGroup_8h_source.html#l00013">KVGroup.h:13</a></div></div>
<div class="ttc" id="KVACQParam_8h_html"><div class="ttname"><a href="KVACQParam_8h.html">KVACQParam.h</a></div></div>
<div class="ttc" id="classKVDetector_html"><div class="ttname"><a href="classKVDetector.html">KVDetector</a></div><div class="ttdef"><b>Definition:</b> <a href="KVDetector_8h_source.html#l00047">KVDetector.h:47</a></div></div>
<div class="ttc" id="classKVGeoDetectorNode_html_ab46bf48b519e9b78a53d3a8cef668f6f"><div class="ttname"><a href="classKVGeoDetectorNode.html#ab46bf48b519e9b78a53d3a8cef668f6f">KVGeoDetectorNode::GetNDetsInFront</a></div><div class="ttdeci">Int_t GetNDetsInFront() const</div><div class="ttdoc">Returns number of detectors directly in front of this one. </div><div class="ttdef"><b>Definition:</b> <a href="KVGeoDetectorNode_8cpp_source.html#l00317">KVGeoDetectorNode.cpp:317</a></div></div>
<div class="ttc" id="classKVMultiDetArray_html_ad915cf18454f95b852e13d3816a51abf"><div class="ttname"><a href="classKVMultiDetArray.html#ad915cf18454f95b852e13d3816a51abf">KVMultiDetArray::GetIDTelescope</a></div><div class="ttdeci">KVIDTelescope * GetIDTelescope(const Char_t *name) const</div><div class="ttdoc">Return pointer to DeltaE-E ID Telescope with &quot;name&quot;. </div><div class="ttdef"><b>Definition:</b> <a href="KVMultiDetArray_8cpp_source.html#l01559">KVMultiDetArray.cpp:1559</a></div></div>
<div class="ttc" id="classKVReconstructedNucleus_html_a2585afc686b533fbe6bd8cff60e63073"><div class="ttname"><a href="classKVReconstructedNucleus.html#a2585afc686b533fbe6bd8cff60e63073">KVReconstructedNucleus::fRealZ</a></div><div class="ttdeci">Float_t fRealZ</div><div class="ttdoc">Z returned by identification routine. </div><div class="ttdef"><b>Definition:</b> <a href="KVReconstructedNucleus_8h_source.html#l00034">KVReconstructedNucleus.h:34</a></div></div>
<div class="ttc" id="classKVReconstructedNucleus_html_a54a6e71d2b5637b4227895540be3e755"><div class="ttname"><a href="classKVReconstructedNucleus.html#a54a6e71d2b5637b4227895540be3e755">KVReconstructedNucleus::SubtractEnergyFromAllDetectors</a></div><div class="ttdeci">virtual void SubtractEnergyFromAllDetectors()</div><div class="ttdef"><b>Definition:</b> <a href="KVReconstructedNucleus_8cpp_source.html#l00835">KVReconstructedNucleus.cpp:835</a></div></div>
<div class="ttc" id="KVTelescope_8h_html"><div class="ttname"><a href="KVTelescope_8h.html">KVTelescope.h</a></div></div>
<div class="ttc" id="classKVParticle_html_ad91ce7b02fb299867f789ed9eec4c291"><div class="ttname"><a href="classKVParticle.html#ad91ce7b02fb299867f789ed9eec4c291">KVParticle::SetEnergy</a></div><div class="ttdeci">void SetEnergy(Double_t e)</div><div class="ttdef"><b>Definition:</b> <a href="KVParticle_8h_source.html#l00199">KVParticle.h:199</a></div></div>
<div class="ttc" id="classKVReconstructedNucleus_html_a9372e92ada83f8277e6a2101da7e7ccf"><div class="ttname"><a href="classKVReconstructedNucleus.html#a9372e92ada83f8277e6a2101da7e7ccf">KVReconstructedNucleus::GetStatus</a></div><div class="ttdeci">Int_t GetStatus() const</div><div class="ttdef"><b>Definition:</b> <a href="KVReconstructedNucleus_8h_source.html#l00128">KVReconstructedNucleus.h:128</a></div></div>
<div class="ttc" id="classKVSeqCollection_html_a664e089215412018fbd8fad91a5a9f2b"><div class="ttname"><a href="classKVSeqCollection.html#a664e089215412018fbd8fad91a5a9f2b">KVSeqCollection::GetSize</a></div><div class="ttdeci">virtual Int_t GetSize() const</div><div class="ttdef"><b>Definition:</b> <a href="KVSeqCollection_8h_source.html#l00158">KVSeqCollection.h:158</a></div></div>
<div class="ttc" id="classKVIDTelescope_html_a782a0aef92fca188d78aacd734daa6c0"><div class="ttname"><a href="classKVIDTelescope.html#a782a0aef92fca188d78aacd734daa6c0">KVIDTelescope::CalculateParticleEnergy</a></div><div class="ttdeci">virtual void CalculateParticleEnergy(KVReconstructedNucleus *nuc)</div><div class="ttdef"><b>Definition:</b> <a href="KVIDTelescope_8cpp_source.html#l00864">KVIDTelescope.cpp:864</a></div></div>
<div class="ttc" id="classKVReconstructedNucleus_html_aaf999e61d798981e0362f519c07b6d4a"><div class="ttname"><a href="classKVReconstructedNucleus.html#aaf999e61d798981e0362f519c07b6d4a">KVReconstructedNucleus::fIDTelName</a></div><div class="ttdeci">KVString fIDTelName</div><div class="ttdoc">name of identification telescope which identified this particle (if any) </div><div class="ttdef"><b>Definition:</b> <a href="KVReconstructedNucleus_8h_source.html#l00021">KVReconstructedNucleus.h:21</a></div></div>
<div class="ttc" id="classKVReconstructedNucleus_html_a29cc65d62e1cc4fe7dd62da20d80e15a"><div class="ttname"><a href="classKVReconstructedNucleus.html#a29cc65d62e1cc4fe7dd62da20d80e15a">KVReconstructedNucleus::GetTargetEnergyLoss</a></div><div class="ttdeci">virtual Double_t GetTargetEnergyLoss() const</div><div class="ttdef"><b>Definition:</b> <a href="KVReconstructedNucleus_8h_source.html#l00289">KVReconstructedNucleus.h:289</a></div></div>
<div class="ttc" id="classKVReconstructedNucleus_html_a0829bc19970446f4e30ae82ff6d176a7"><div class="ttname"><a href="classKVReconstructedNucleus.html#a0829bc19970446f4e30ae82ff6d176a7">KVReconstructedNucleus::MakeDetectorList</a></div><div class="ttdeci">void MakeDetectorList()</div><div class="ttdef"><b>Definition:</b> <a href="KVReconstructedNucleus_8cpp_source.html#l00792">KVReconstructedNucleus.cpp:792</a></div></div>
<div class="ttc" id="classKVReconstructedNucleus_html_a225bc41a3152a3f98c19676bc9f09bcfafa07abf430979404ec72497bd656189c"><div class="ttname"><a href="classKVReconstructedNucleus.html#a225bc41a3152a3f98c19676bc9f09bcfafa07abf430979404ec72497bd656189c">KVReconstructedNucleus::kStatusOKafterSub</a></div><div class="ttdef"><b>Definition:</b> <a href="KVReconstructedNucleus_8h_source.html#l00047">KVReconstructedNucleus.h:47</a></div></div>
<div class="ttc" id="classKVNucleus_html_a0f37b7c776b5f50bc58773534e815a34"><div class="ttname"><a href="classKVNucleus.html#a0f37b7c776b5f50bc58773534e815a34">KVNucleus::Clear</a></div><div class="ttdeci">virtual void Clear(Option_t *opt=&quot;&quot;)</div><div class="ttdef"><b>Definition:</b> <a href="KVNucleus_8cpp_source.html#l00465">KVNucleus.cpp:465</a></div></div>
<div class="ttc" id="classKVReconstructedNucleus_html_af4b1df3ef31220dd1c0b75929f617a2e"><div class="ttname"><a href="classKVReconstructedNucleus.html#af4b1df3ef31220dd1c0b75929f617a2e">KVReconstructedNucleus::IsAMeasured</a></div><div class="ttdeci">virtual Bool_t IsAMeasured() const</div><div class="ttdef"><b>Definition:</b> <a href="KVReconstructedNucleus_8h_source.html#l00313">KVReconstructedNucleus.h:313</a></div></div>
<div class="ttc" id="classKVDetector_html_ac60bd4797fc7ccdd07bfd32742ed50bc"><div class="ttname"><a href="classKVDetector.html#ac60bd4797fc7ccdd07bfd32742ed50bc">KVDetector::GetAlignedDetectors</a></div><div class="ttdeci">virtual TList * GetAlignedDetectors(UInt_t direction=1)</div><div class="ttdef"><b>Definition:</b> <a href="KVDetector_8cpp_source.html#l02049">KVDetector.cpp:2049</a></div></div>
<div class="ttc" id="classKVDetector_html_a92d1fd5bd481943baf0b192cedb1f924"><div class="ttname"><a href="classKVDetector.html#a92d1fd5bd481943baf0b192cedb1f924">KVDetector::SetEnergyLoss</a></div><div class="ttdeci">virtual void SetEnergyLoss(Double_t e)</div><div class="ttdef"><b>Definition:</b> <a href="KVDetector_8h_source.html#l00216">KVDetector.h:216</a></div></div>
<div class="ttc" id="classKVDetector_html_a270ceeb047bf0d3037d7e71ff5dd0f5c"><div class="ttname"><a href="classKVDetector.html#a270ceeb047bf0d3037d7e71ff5dd0f5c">KVDetector::GetERes</a></div><div class="ttdeci">virtual Double_t GetERes(Int_t Z, Int_t A, Double_t Einc)</div><div class="ttdef"><b>Definition:</b> <a href="KVDetector_8cpp_source.html#l01807">KVDetector.cpp:1807</a></div></div>
<div class="ttc" id="classKVParticle_html_a71cee813f08cc41e8aa141c1e5df32db"><div class="ttname"><a href="classKVParticle.html#a71cee813f08cc41e8aa141c1e5df32db">KVParticle::GetPhi</a></div><div class="ttdeci">Double_t GetPhi() const</div><div class="ttdef"><b>Definition:</b> <a href="KVParticle_8h_source.html#l00288">KVParticle.h:288</a></div></div>
<div class="ttc" id="classKVReconstructedNucleus_html_a3ef7eb98de0bea44a95d80b2c3f4873f"><div class="ttname"><a href="classKVReconstructedNucleus.html#a3ef7eb98de0bea44a95d80b2c3f4873f">KVReconstructedNucleus::GetRealZ</a></div><div class="ttdeci">Float_t GetRealZ() const</div><div class="ttdef"><b>Definition:</b> <a href="KVReconstructedNucleus_8h_source.html#l00256">KVReconstructedNucleus.h:256</a></div></div>
<div class="ttc" id="classKVReconstructedNucleus_html_ab6633c009bfb20f21144345d445be766"><div class="ttname"><a href="classKVReconstructedNucleus.html#ab6633c009bfb20f21144345d445be766">KVReconstructedNucleus::SetRealZ</a></div><div class="ttdeci">void SetRealZ(Float_t zz)</div><div class="ttdef"><b>Definition:</b> <a href="KVReconstructedNucleus_8h_source.html#l00248">KVReconstructedNucleus.h:248</a></div></div>
<div class="ttc" id="classKVNucleus_html_ae9060d423b1a4a895e1305cc31631127"><div class="ttname"><a href="classKVNucleus.html#ae9060d423b1a4a895e1305cc31631127">KVNucleus::GetZ</a></div><div class="ttdeci">Int_t GetZ() const</div><div class="ttdoc">Return the number of proton / atomic number. </div><div class="ttdef"><b>Definition:</b> <a href="KVNucleus_8cpp_source.html#l00924">KVNucleus.cpp:924</a></div></div>
<div class="ttc" id="classKVMultiDetArray_html_a849e85bb6dbee9ba7f5d46158137bd49"><div class="ttname"><a href="classKVMultiDetArray.html#a849e85bb6dbee9ba7f5d46158137bd49">KVMultiDetArray::FillDetectorList</a></div><div class="ttdeci">virtual void FillDetectorList(KVReconstructedNucleus *rnuc, KVHashList *DetList, const KVString &amp;DetNames)</div><div class="ttdef"><b>Definition:</b> <a href="KVMultiDetArray_8cpp_source.html#l03653">KVMultiDetArray.cpp:3653</a></div></div>
<div class="ttc" id="classKVReconstructedNucleus_html_aa2a59c5233f1e1311ae3a101b8343538"><div class="ttname"><a href="classKVReconstructedNucleus.html#aa2a59c5233f1e1311ae3a101b8343538">KVReconstructedNucleus::init</a></div><div class="ttdeci">void init()</div><div class="ttdoc">default initialisation </div><div class="ttdef"><b>Definition:</b> <a href="KVReconstructedNucleus_8cpp_source.html#l00084">KVReconstructedNucleus.cpp:84</a></div></div>
<div class="ttc" id="classKVReconstructedNucleus_html_a5e31b825f37f9d210d34d2b56118e94f"><div class="ttname"><a href="classKVReconstructedNucleus.html#a5e31b825f37f9d210d34d2b56118e94f">KVReconstructedNucleus::fRealA</a></div><div class="ttdeci">Float_t fRealA</div><div class="ttdoc">A returned by identification routine. </div><div class="ttdef"><b>Definition:</b> <a href="KVReconstructedNucleus_8h_source.html#l00035">KVReconstructedNucleus.h:35</a></div></div>
<div class="ttc" id="classKVReconstructedNucleus_html_a225bc41a3152a3f98c19676bc9f09bcfaf62c208cd36657fe89f2adde45f661e7"><div class="ttname"><a href="classKVReconstructedNucleus.html#a225bc41a3152a3f98c19676bc9f09bcfaf62c208cd36657fe89f2adde45f661e7">KVReconstructedNucleus::kStatusPileupDE</a></div><div class="ttdef"><b>Definition:</b> <a href="KVReconstructedNucleus_8h_source.html#l00053">KVReconstructedNucleus.h:53</a></div></div>
<div class="ttc" id="classKVDetector_html_a99b4e60ca22d148781ef3d20416f7e17"><div class="ttname"><a href="classKVDetector.html#a99b4e60ca22d148781ef3d20416f7e17">KVDetector::GetNameOfArray</a></div><div class="ttdeci">const Char_t * GetNameOfArray() const</div><div class="ttdef"><b>Definition:</b> <a href="KVDetector_8h_source.html#l00469">KVDetector.h:469</a></div></div>
<div class="ttc" id="classKVReconstructedNucleus_html_abf0045dbdf91cab40330f31d09e9f4d6"><div class="ttname"><a href="classKVReconstructedNucleus.html#abf0045dbdf91cab40330f31d09e9f4d6">KVReconstructedNucleus::SetZMeasured</a></div><div class="ttdeci">virtual void SetZMeasured(Bool_t yes=kTRUE)</div><div class="ttdef"><b>Definition:</b> <a href="KVReconstructedNucleus_8h_source.html#l00295">KVReconstructedNucleus.h:295</a></div></div>
<div class="ttc" id="classKVReconstructedNucleus_html_a1b7c1c65909b9715c7a759a5bfb5da44"><div class="ttname"><a href="classKVReconstructedNucleus.html#a1b7c1c65909b9715c7a759a5bfb5da44">KVReconstructedNucleus::Calibrate</a></div><div class="ttdeci">virtual void Calibrate()</div><div class="ttdef"><b>Definition:</b> <a href="KVReconstructedNucleus_8cpp_source.html#l00752">KVReconstructedNucleus.cpp:752</a></div></div>
<div class="ttc" id="classKVDetector_html_af044a7fef3d1b909bd924479c8a410dc"><div class="ttname"><a href="classKVDetector.html#af044a7fef3d1b909bd924479c8a410dc">KVDetector::Print</a></div><div class="ttdeci">virtual void Print(Option_t *option=&quot;&quot;) const</div><div class="ttdef"><b>Definition:</b> <a href="KVDetector_8cpp_source.html#l00529">KVDetector.cpp:529</a></div></div>
<div class="ttc" id="KVMultiDetArray_8cpp_html_a2554fcc03212b313926f80da25349ae5"><div class="ttname"><a href="KVMultiDetArray_8cpp.html#a2554fcc03212b313926f80da25349ae5">gMultiDetArray</a></div><div class="ttdeci">KVMultiDetArray * gMultiDetArray</div><div class="ttdef"><b>Definition:</b> <a href="KVMultiDetArray_8cpp_source.html#l00052">KVMultiDetArray.cpp:52</a></div></div>
<div class="ttc" id="classKVDetector_html_ac631b3547c5dceac6882b6138cdaba00"><div class="ttname"><a href="classKVDetector.html#ac631b3547c5dceac6882b6138cdaba00">KVDetector::GetNode</a></div><div class="ttdeci">KVGeoDetectorNode * GetNode()</div><div class="ttdef"><b>Definition:</b> <a href="KVDetector_8h_source.html#l00179">KVDetector.h:179</a></div></div>
<div class="ttc" id="classKVIDTelescope_html_a062c3bf3961e074aca8f0bf2ba8a1a6d"><div class="ttname"><a href="classKVIDTelescope.html#a062c3bf3961e074aca8f0bf2ba8a1a6d">KVIDTelescope::IsReadyForID</a></div><div class="ttdeci">virtual Bool_t IsReadyForID()</div><div class="ttdef"><b>Definition:</b> <a href="KVIDTelescope_8h_source.html#l00164">KVIDTelescope.h:164</a></div></div>
<div class="ttc" id="classKVReconstructedNucleus_html_ae83b684ae5a330645677bd86db4e0caf"><div class="ttname"><a href="classKVReconstructedNucleus.html#ae83b684ae5a330645677bd86db4e0caf">KVReconstructedNucleus::GetGroup</a></div><div class="ttdeci">KVGroup * GetGroup() const</div><div class="ttdef"><b>Definition:</b> <a href="KVReconstructedNucleus_8h_source.html#l00155">KVReconstructedNucleus.h:155</a></div></div>
<div class="ttc" id="classKVParticle_html_a3d93f8bb12e37d184d074caca69dfb44"><div class="ttname"><a href="classKVParticle.html#a3d93f8bb12e37d184d074caca69dfb44">KVParticle::SetMomentum</a></div><div class="ttdeci">void SetMomentum(const TVector3 &amp;v)</div><div class="ttdef"><b>Definition:</b> <a href="KVParticle_8h_source.html#l00174">KVParticle.h:174</a></div></div>
<div class="ttc" id="KVMultiDetArray_8h_html"><div class="ttname"><a href="KVMultiDetArray_8h.html">KVMultiDetArray.h</a></div></div>
<div class="ttc" id="classKVIDTelescope_html_a8c1eff10aff1a96f831b3ef045cdf331ada914c753214563d9a32bdc5f9e6d7ad"><div class="ttname"><a href="classKVIDTelescope.html#a8c1eff10aff1a96f831b3ef045cdf331ada914c753214563d9a32bdc5f9e6d7ad">KVIDTelescope::kCalibStatus_NoCalibrations</a></div><div class="ttdef"><b>Definition:</b> <a href="KVIDTelescope_8h_source.html#l00063">KVIDTelescope.h:63</a></div></div>
<div class="ttc" id="classKVDetector_html_acfee1c714ddc99d62a026c4de199fbbe"><div class="ttname"><a href="classKVDetector.html#acfee1c714ddc99d62a026c4de199fbbe">KVDetector::GetDeltaE</a></div><div class="ttdeci">virtual Double_t GetDeltaE(Int_t Z, Int_t A, Double_t Einc)</div><div class="ttdef"><b>Definition:</b> <a href="KVDetector_8cpp_source.html#l01774">KVDetector.cpp:1774</a></div></div>
<div class="ttc" id="classKVIdentificationResult_html_aaf673002ffbf729874578beb71147c3a"><div class="ttname"><a href="classKVIdentificationResult.html#aaf673002ffbf729874578beb71147c3a">KVIdentificationResult::A</a></div><div class="ttdeci">Int_t A</div><div class="ttdoc">A of particle found (if Aident==kTRUE) </div><div class="ttdef"><b>Definition:</b> <a href="KVIdentificationResult_8h_source.html#l00016">KVIdentificationResult.h:16</a></div></div>
<div class="ttc" id="classKVReconstructedNucleus_html_ae3ec6de68771df778fc503f33e6bc815"><div class="ttname"><a href="classKVReconstructedNucleus.html#ae3ec6de68771df778fc503f33e6bc815">KVReconstructedNucleus::AnalyseParticlesInGroup</a></div><div class="ttdeci">static void AnalyseParticlesInGroup(KVGroup *grp)</div><div class="ttdef"><b>Definition:</b> <a href="KVReconstructedNucleus_8cpp_source.html#l00544">KVReconstructedNucleus.cpp:544</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Wed May 30 2018 17:40:10 for KaliVeda by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.13
</small></address>
</body>
</html>
